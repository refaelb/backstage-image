"use strict";(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1447],{1447:(bt,re,n)=>{n.r(re),n.d(re,{LegacyRouter:()=>xt});var e=n(2784),M=n(73557),h=n(49558),R=n(30705),L=n(57032),ye=n(78373),I=n(73495),w=n(34520),Me=n(67898),F=n(79692),b=n(90436),J=n(80030),Ce=n(60364),X=n(94339),Te=n(16111),q=n(24579),G=n(95544),Ae=n(7089),Re=n(14503),j=n(61837),Le=n(27556),z=n(77277),Ie=n(31625),We=n(31377),Be=n(34546),Ue=n(63115),le=n(67358),oe=n(42494),se=n(56939),ie=n(73698),k=n(12231),ce=n(32552),me=n(49462),Ee=n(52160),Ze=n(39781),y=n(94063),Se=n(75650),xe=n(56563),ee=n(86136),te=n(49378),be=n(50758),Ke=n(79784),Fe=n(30254),Ne=n(27604),we=n(33882),je=n(43054),Kt=n(29641),ze=n(19126),de=n.n(ze),ue=n(64279),V=n(60885),_e=n(12053),$e=n(95303),ke=n(90137),Ve=n(9850),He=n.n(Ve),pe=n(11280),fe=n(31011),W=n(33761),Ye=n(48760),ae=n(10921),ge=n(87685),Je=n(77120),Ge=n(42123),Qe=n(2552),Xe=n(82394),Ft=n.n(Xe),qe=n(31734),Nt=n.n(qe),et=n(82108),wt=n.n(et),tt=n(12524),jt=n.n(tt),zt=n(26228),at=n(75951),$t=n.n(at);const nt=(0,F.Z)(t=>({cardHeader:{position:"relative"},title:{backgroundImage:({backgroundImage:a})=>a,color:({fontColor:a})=>a},box:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box","-webkit-line-clamp":10,"-webkit-box-orient":"vertical"},label:{color:t.palette.text.secondary,textTransform:"uppercase",fontSize:"0.65rem",fontWeight:"bold",letterSpacing:.5,lineHeight:1,paddingBottom:"0.2rem"},linksLabel:{padding:"0 16px"},description:{"& p":{margin:"0px"}},leftButton:{marginRight:"auto"},starButton:{position:"absolute",top:t.spacing(.5),right:t.spacing(.5),padding:"0.25rem",color:({fontColor:a})=>a}})),ve=({icon:t})=>e.createElement(t,null),rt=(0,F.Z)(t=>({deprecationIcon:{position:"absolute",top:t.spacing(.5),right:t.spacing(3.5),padding:"0.25rem"},link:{color:t.palette.warning.light}})),lt=t=>{var a,l,s,r,i,c;return{key:t.metadata.uid,name:t.metadata.name,title:`${(a=t.metadata.title||t.metadata.name)!=null?a:""}`,type:(l=t.spec.type)!=null?l:"",description:(s=t.metadata.description)!=null?s:"-",tags:(i=(r=t.metadata)==null?void 0:r.tags)!=null?i:[],links:(c=t.metadata.links)!=null?c:[]}},ot=()=>{const t=rt(),a=e.createElement(b.Z,{style:{padding:10,maxWidth:300}},"This template uses a syntax that has been deprecated, and should be migrated to a newer syntax. Click for more info.");return e.createElement("div",{className:t.deprecationIcon},e.createElement(J.ZP,{title:a},e.createElement(h.rU,{to:"https://backstage.io/docs/features/software-templates/migrating-from-v1beta2-to-v1beta3",className:t.link},e.createElement(Ze.Z,null))))},st=({template:t,deprecated:a})=>{var l,s,r;const i=(0,R.qD)(),c=(0,Ce.Z)(),m=(0,R.tg)(y.o),o=lt(t),p=(0,ye.g)(t,w.S4),E=c.getPageTheme({themeId:o.type})?o.type:"other",f=c.getPageTheme({themeId:E}),u=nt({fontColor:f.fontColor,backgroundImage:f.backgroundImage}),{name:O,namespace:_}=(0,w.of)((0,w.eE)(t)),v=m({templateName:O,namespace:_}),D=(0,R.tg)(y.v),d=!!((l=t.metadata.annotations)==null?void 0:l["backstage.io/techdocs-ref"])&&!!D&&D({namespace:t.metadata.namespace||w.zG,kind:t.kind,name:t.metadata.name}),g=T=>{var K;return T&&(K=i.getSystemIcon(T))!=null?K:Ee.Z},Z=(0,L.u)(me.q3),B=(0,I.CV)(t,Z);return e.createElement(X.Z,null,e.createElement(Te.Z,{className:u.cardHeader},e.createElement(I.LH,{className:u.starButton,entity:t}),a&&e.createElement(ot,null),e.createElement(h.hu,{title:o.title,subtitle:o.type,classes:{root:u.title}})),e.createElement(q.Z,{style:{display:"flex",flexDirection:"column",gap:"16px"}},e.createElement(G.Z,{className:u.box},e.createElement(b.Z,{variant:"body2",className:u.label},"Description"),e.createElement(h.SA,{className:u.description,content:o.description})),e.createElement(G.Z,{className:u.box},e.createElement(b.Z,{variant:"body2",className:u.label},"Owner"),e.createElement(I.rI,{entityRefs:p,defaultKind:"Group",hideIcons:!0})),e.createElement(G.Z,null,e.createElement(b.Z,{style:{marginBottom:"4px"},variant:"body2",className:u.label},"Tags"),(s=o.tags)==null?void 0:s.map(T=>e.createElement(Ae.Z,{size:"small",label:T,key:T})))),e.createElement(b.Z,{variant:"body2",className:[u.label,u.linksLabel].join(" ")},"Links"),e.createElement(Re.Z,null,e.createElement("div",{className:u.leftButton},B&&e.createElement(J.ZP,{title:B.integrationType||B.locationTargetUrl},e.createElement(j.Z,{className:u.leftButton,href:B.locationTargetUrl},e.createElement(me.nW,{type:B.integrationType}))),d&&e.createElement(J.ZP,{title:"View TechDocs"},e.createElement(j.Z,{className:u.leftButton,href:d},e.createElement(ve,{icon:g("docs")}))),(r=o.links)==null?void 0:r.map((T,K)=>e.createElement(J.ZP,{key:`${T.url}_${K}`,title:T.title||T.url},e.createElement(j.Z,{size:"medium",href:T.url},e.createElement(ve,{icon:g(T.icon)}))))),e.createElement(h.Qj,{color:"primary",to:v,"aria-label":`Choose ${o.title}`},"Choose")))},he=({TemplateCardComponent:t,group:a,templateFilter:l})=>{const{loading:s,error:r,entities:i}=(0,I.wp)(),c=t||st,m=i.filter(Me.t),o=(a?m.filter(a.filter):m).filter(E=>l?l(E):!0),p=(()=>a&&a.title?typeof a.title=="string"?e.createElement(h.yW,{title:a.title}):a.title:e.createElement(h.yW,{title:"Other Templates"}))();return a&&o.length===0?null:e.createElement(e.Fragment,null,s&&e.createElement(h.Ex,null),r&&e.createElement(h.GB,{title:"Oops! Something went wrong loading the templates"},r.message),!r&&!s&&!i.length&&e.createElement(b.Z,{variant:"body2"},"No templates found that match your filter. Learn more about"," ",e.createElement(h.rU,{to:"https://backstage.io/docs/features/software-templates/adding-templates"},"adding templates"),"."),e.createElement(h.VY,null,p,e.createElement(h.Oh,null,o&&(o==null?void 0:o.length)>0&&o.map(E=>e.createElement(c,{key:(0,w.eE)(E),template:E,deprecated:E.apiVersion==="backstage.io/v1beta2"})))))},it=(0,F.Z)(t=>({button:{color:t.page.fontColor}}));function ct(t){const a=it(),[l,s]=(0,e.useState)(),r=(0,R.tg)(y.p),i=(0,R.tg)(y.q),c=(0,R.tg)(y.t),m=(0,M.s0)(),o=t.editor!==!1,p=t.actions!==!1,E=t.tasks!==!1;if(!o&&!p)return null;const f=O=>{s(O.currentTarget)},u=()=>{s(void 0)};return e.createElement(e.Fragment,null,e.createElement(j.Z,{id:"long-menu","aria-label":"more","aria-controls":"long-menu","aria-expanded":!!l,"aria-haspopup":"true",role:"button",onClick:f,"data-testid":"menu-button",color:"inherit",className:a.button},e.createElement(je.Z,null)),e.createElement(Ke.ZP,{"aria-labelledby":"long-menu",open:Boolean(l),onClose:u,anchorEl:l,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},e.createElement(be.Z,null,o&&e.createElement(k.Z,{onClick:()=>m(r())},e.createElement(ee.Z,null,e.createElement(Ne.Z,{fontSize:"small"})),e.createElement(te.Z,{primary:"Template Editor"})),p&&e.createElement(k.Z,{onClick:()=>m(i())},e.createElement(ee.Z,null,e.createElement(Fe.Z,{fontSize:"small"})),e.createElement(te.Z,{primary:"Installed Actions"})),E&&e.createElement(k.Z,{onClick:()=>m(c())},e.createElement(ee.Z,null,e.createElement(we.Z,{fontSize:"small"})),e.createElement(te.Z,{primary:"Task List"})))))}const mt=({TemplateCardComponent:t,groups:a,templateFilter:l,contextMenu:s,headerOptions:r})=>{const i=(0,R.tg)(y.u),c={title:a?"Other Templates":"Templates",filter:o=>!(a!=null?a:[]).map(E=>E.filter(o)).some(E=>E===!0)},{allowed:m}=(0,xe.gI)({permission:Se.x7});return e.createElement(h.T3,{themeId:"home"},e.createElement(h.h4,{pageTitleOverride:"Create a New Component",title:"Create a New Component",subtitle:"Create new software components using standard templates",...r},e.createElement(ct,{...s})),e.createElement(h.VY,null,e.createElement(h.yW,{title:"Available Templates"},m&&e.createElement(h.XF,{title:"Register Existing Component",to:i&&i()}),e.createElement(h.qt,null,"Create new software components using standard templates. Different templates create different kinds of components (services, websites, documentation, ...).")),e.createElement(I._i,null,e.createElement(I._i.Filters,null,e.createElement(I.nN,null),e.createElement(I.tW,{initialFilter:"template",hidden:!0}),e.createElement(I.EW,{initialFilter:"all",availableFilters:["all","starred"]}),e.createElement(y.T,null),e.createElement(I.xE,null)),e.createElement(I._i.Content,null,a&&a.map((o,p)=>e.createElement(he,{key:p,TemplateCardComponent:t,group:o,templateFilter:l})),e.createElement(he,{key:"other",TemplateCardComponent:t,templateFilter:l,group:c})))))},Et=({TemplateCardComponent:t,groups:a,templateFilter:l,contextMenu:s,headerOptions:r})=>e.createElement(I.UO,null,e.createElement(mt,{TemplateCardComponent:t,groups:a,templateFilter:l,contextMenu:s,headerOptions:r}));function x(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function N(t,a){if(!x(t))return;const{properties:l,items:s,anyOf:r,oneOf:i,allOf:c,dependencies:m}=t;for(const o in t)t.hasOwnProperty(o)&&o.startsWith("ui:")&&(a[o]=t[o],delete t[o]);if(x(l))for(const o in l){if(!l.hasOwnProperty(o))continue;const p=l[o];if(!x(p))continue;const E={};a[o]=a[o]||E,N(p,E)}if(x(s)){const o={};a.items=o,N(s,o)}if(Array.isArray(r))for(const o of r)x(o)&&N(o,a);if(Array.isArray(i))for(const o of i)x(o)&&N(o,a);if(Array.isArray(c))for(const o of c)x(o)&&N(o,a);if(x(m))for(const o of Object.keys(m)){const p=m[o];x(p)&&N(p,a)}}function dt(t,a=[]){var l;const s=t["ui:ObjectFieldTemplate"];t.type=t.type||"object";const r=JSON.parse(JSON.stringify(t));delete r.title;const i={};if(N(r,i),s){const c=(l=a.find(m=>m.name===s))==null?void 0:l.component;c&&(i["ui:ObjectFieldTemplate"]=c)}return{schema:r,uiSchema:i}}var ut=Object.freeze({__proto__:null,DescriptionField:({description:t})=>t&&e.createElement(h.SA,{content:t,linkTarget:"_blank"})});function _t(t,a){const l={},s=new Set(a.map(r=>r.name).concat(Object.getOwnPropertyNames(t)));for(const r of s){const i=a.find(m=>m.name===r);if(!i){l[r]=t[r];continue}if(i["ui:widget"]==="password"){l[r]="******";continue}if(!i["ui:backstage"]||!i["ui:backstage"].review){l[r]=t[r];continue}const c=i["ui:backstage"].review;if(c.mask){l[r]=c.mask;continue}c.show&&(l[r]=t[r])}return l}function pt(t){const a=[];return t.forEach(l=>{const s=l.schema.properties;for(const r in s)if(s.hasOwnProperty(r)){const i=s[r];i.name=r,a.push(i)}}),a}const ft=t=>{const{disableButtons:a,formData:l,handleBack:s,handleCreate:r,handleReset:i,steps:c}=t;return e.createElement(h.VY,null,e.createElement(Le.Z,{square:!0,elevation:0},e.createElement(b.Z,{variant:"h6"},"Review and create"),e.createElement(h.xT,{dense:!0,metadata:_t(l,pt(c.map(({mergedSchema:m})=>({schema:m}))))}),e.createElement(G.Z,{mb:4}),e.createElement(z.Z,{onClick:s,disabled:a},"Back"),e.createElement(z.Z,{onClick:i,disabled:a},"Reset"),e.createElement(z.Z,{variant:"contained",color:"primary",onClick:r,disabled:a},"Create")))},gt=(0,$e.Zz)(ke.Q2);function vt(t){return t.map(({schema:a})=>({mergedSchema:a,...(0,fe.mg)(a)}))}const Oe=t=>{const{formData:a,onChange:l,onReset:s,onFinish:r,fields:i,widgets:c,layouts:m,ReviewStepComponent:o}=t,{templateName:p}=(0,R.Oi)(y.o),E=(0,R.z$)(),[f,u]=(0,e.useState)(0),[O,_]=(0,e.useState)(!1),v=(0,L.u)(L.r),D=(0,L.u)(L.f),C="backstage:featureFlag",d=P=>{var S;const U=He()(P),Q=[];return U.schema.properties&&(U.schema.properties=Object.fromEntries(Object.entries(U.schema.properties).filter(([Y,De])=>De[C]?D.isActive(De[C])?!0:(Q.push(Y),!1):!0)),U.schema.required=Array.isArray(U.schema.required)?(S=U.schema.required)==null?void 0:S.filter(Y=>!Q.includes(Y)):U.schema.required),U},g=t.steps.filter(P=>{const S=P.schema[C];return typeof S!="string"||D.isActive(S)}).map(d),Z=()=>{u(0),s()},B=()=>{const P=Math.min(f+1,g.length);u(P),E.captureEvent("click",`Next Step (${P})`)},T=()=>u(Math.max(f-1,0)),K=async()=>{if(r){_(!0);try{await r(),E.captureEvent("create",a.name||`new ${p}`)}catch(P){v.post(P)}finally{_(!1)}}},A=o!=null?o:ft;return e.createElement(e.Fragment,null,e.createElement(Ie.Z,{activeStep:f,orientation:"vertical"},g.map(({title:P,schema:S,...U},Q)=>e.createElement(We.Z,{key:P},e.createElement(Be.Z,{"aria-label":`Step ${Q+1} ${P}`,"aria-disabled":"false",tabIndex:0},e.createElement(b.Z,{variant:"h6",component:"h2"},P)),e.createElement(Ue.Z,{key:P},e.createElement(gt,{validator:pe.ZP,showErrorList:!1,fields:{...ut,...i},widgets:c,noHtml5Validate:!0,formData:a,formContext:{formData:a},onChange:l,onSubmit:Y=>{Y.errors.length===0&&B()},experimental_defaultFormStateBehavior:{allOf:"populateDefaults"},...U,...dt(S,m)},e.createElement(z.Z,{disabled:f===0,onClick:T},"Back"),e.createElement(z.Z,{variant:"contained",color:"primary",type:"submit"},"Next step")))))),f===g.length&&e.createElement(A,{disableButtons:O,handleBack:T,handleCreate:K,handleReset:Z,formData:a,steps:vt(g)}))};function $(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function ht(t){return typeof t=="object"&&t!==null&&Array.isArray(t)}const Pe=(t,a,l)=>{function s(r,i,c){var m;const o=r.properties,p=r.type==="object"&&o===void 0;if(!(!$(o)&&!p)){if(o)for(const[E,f]of Object.entries(i)){const u=c[E],O=v=>{if(v&&$(v)){const D=v["ui:field"];D&&typeof a[D]=="function"&&a[D](f,u,l)}},_=o[E];if($(f)&&$(_))s(_,f,u);else if(ht(f)){if($(_)){const{items:v}=_;if($(v))if(v.type==="object"){const D=(m=v==null?void 0:v.properties)!=null?m:[];for(const[,C]of Object.entries(D))O(C)}else O(v)}}else O(_)}else if(p){const E=r["ui:field"];E&&typeof a[E]=="function"&&a[E](i,c,l)}}}return(r,i)=>(s(t,r,i),i)},Ot=t=>{const a=(0,L.u)(V.s),{value:l,loading:s,error:r}=(0,ue.default)(()=>a.getTemplateParameterSchema(t),[a,t]);return{schema:l,loading:s,error:r}},Pt=({ReviewStepComponent:t,customFieldExtensions:a=[],layouts:l=[],headerOptions:s})=>{const r=(0,L.b)(),i=(0,V.u)(),c=(0,L.u)(L.r),m=(0,L.u)(V.s),{templateName:o,namespace:p}=(0,R.Oi)(y.o),E=(0,w.eE)({name:o,kind:"template",namespace:p}),f=(0,M.s0)(),u=(0,R.tg)(y.w),O=(0,R.tg)(y.r),{schema:_,loading:v,error:D}=Ot(E),[C,d]=(0,e.useState)(()=>{var A;const P=de().parse(window.location.search,{ignoreQueryPrefix:!0});try{return JSON.parse(P.formData)}catch{return(A=P.formData)!=null?A:{}}}),g=()=>d({}),Z=(0,e.useCallback)(A=>d(A.formData),[d]),B=async()=>{var A;const{taskId:P}=await m.scaffold({templateRef:E,values:C,secrets:i==null?void 0:i.secrets}),S=de().stringify({formData:C},{addQueryPrefix:!0}),U=`${window.location.pathname}${S}`;(A=window.history)==null||A.replaceState(null,document.title,U),f(u({taskId:P}))};if(D)return c.post(new Error(`Failed to load template, ${D}`)),e.createElement(M.Fg,{to:O()});if(!v&&!_)return c.post(new Error("Template was not found.")),e.createElement(M.Fg,{to:O()});const T=Object.fromEntries(a.map(({name:A,component:P})=>[A,P])),K=Object.fromEntries(a.map(({name:A,validation:P})=>[A,P]));return e.createElement(R.fC,{attributes:{entityRef:E}},e.createElement(h.T3,{themeId:"home"},e.createElement(h.h4,{pageTitleOverride:"Create a New Component",title:"Create a New Component",subtitle:"Create new software components using standard templates",...s}),e.createElement(h.VY,null,v&&e.createElement(le.Z,{"data-testid":"loading-progress"}),_&&e.createElement(h.rJ,{title:_.title,noPadding:!0,titleTypographyProps:{component:"h2"}},e.createElement(Oe,{ReviewStepComponent:t,formData:C,fields:T,onChange:Z,onReset:g,onFinish:B,layouts:l,steps:_.steps.map(A=>({...A,validate:Pe(A.schema,K,{apiHolder:r})}))})))))};var Dt=Object.defineProperty,yt=(t,a,l)=>a in t?Dt(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l,Mt=(t,a,l)=>(yt(t,typeof a!="symbol"?a+"":a,l),l);const Ct=(0,F.Z)({containerWrapper:{position:"relative",width:"100%",height:"100%"},container:{position:"absolute",top:0,bottom:0,left:0,right:0,overflow:"auto"}});class Tt extends e.Component{constructor(){super(...arguments),Mt(this,"state",{shouldRender:!0})}componentDidUpdate(a){a.invalidator!==this.props.invalidator&&this.setState({shouldRender:!0})}componentDidCatch(a){this.props.setErrorText(a.message),this.setState({shouldRender:!1})}render(){return this.state.shouldRender?this.props.children:null}}function ne(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function H(t){const{content:a,contentIsSpec:l,data:s,onUpdate:r,onDryRun:i,setErrorText:c,fieldExtensions:m=[],layouts:o=[]}=t,p=Ct(),E=(0,L.b)(),[f,u]=(0,e.useState)(),O=(0,e.useMemo)(()=>Object.fromEntries(m.map(({name:_,component:v})=>[_,v])),[m]);return(0,Ye.Z)(()=>{try{if(!a){u(void 0);return}const _=ae.ZP.parseAllDocuments(a).filter(d=>d).map(d=>d.toJSON())[0];if(!ne(_)){u(void 0);return}let v=_;if(!l){if(!(String(_.kind).toLocaleLowerCase("en-US")==="template")){u(void 0);return}v=ne(_.spec)?_.spec:{}}const{parameters:D}=v;if(!Array.isArray(D)){c("Template parameters must be an array"),u(void 0);return}const C=Object.fromEntries(m.map(({name:d,validation:g})=>[d,g]));c(),u(D.flatMap(d=>ne(d)?[{title:String(d.title),schema:d,validate:Pe(d,C,{apiHolder:E})}]:[]))}catch(_){c(_.message)}},250,[l,a,E]),f?e.createElement("div",{className:p.containerWrapper},e.createElement("div",{className:p.container},e.createElement(Tt,{invalidator:f,setErrorText:c},e.createElement(Oe,{steps:f,fields:O,formData:s,onChange:_=>r(_.formData),onReset:()=>r({}),finishButtonLabel:i&&"Try It",onFinish:i&&(()=>i(s)),layouts:o})))):null}function At(t){const{setErrorText:a,fieldExtensions:l=[],layouts:s}=t,r=(0,W.u)(),i=(0,W.a)(),{selectedFile:c}=i,[m,o]=(0,e.useState)({}),p=async()=>{if(c)try{await r.execute({templateContent:c.content,values:m,files:i.files}),a()}catch(f){throw a(String(f.cause||f)),f}},E=c&&c.path.match(/\.ya?ml$/)?c.content:void 0;return e.createElement(H,{onDryRun:p,fieldExtensions:l,setErrorText:a,content:E,data:m,onUpdate:o,layouts:s})}H.DirectoryEditorDryRun=At;const Rt=(0,F.Z)({root:{gridArea:"pageContent",display:"grid",gridTemplateAreas:`
      "browser editor preview"
      "results results results"
    `,gridTemplateColumns:"1fr 3fr 2fr",gridTemplateRows:"1fr auto"},browser:{gridArea:"browser",overflow:"auto"},editor:{gridArea:"editor",overflow:"auto"},preview:{gridArea:"preview",overflow:"auto"},results:{gridArea:"results"}}),Lt=t=>{const a=Rt(),[l,s]=(0,e.useState)();return e.createElement(W.D,{directory:t.directory},e.createElement(W.b,null,e.createElement("main",{className:a.root},e.createElement("section",{className:a.browser},e.createElement(W.T,{onClose:t.onClose})),e.createElement("section",{className:a.editor},e.createElement(W.c.DirectoryEditor,{errorText:l})),e.createElement("section",{className:a.preview},e.createElement(H.DirectoryEditorDryRun,{setErrorText:s,fieldExtensions:t.fieldExtensions,layouts:t.layouts})),e.createElement("section",{className:a.results},e.createElement(W.d,null)))))},It=`# Edit the template parameters below to see how they will render in the scaffolder form UI
parameters:
  - title: Fill in some steps
    required:
      - name
    properties:
      name:
        title: Name
        type: string
        description: Unique name of the component
      owner:
        title: Owner
        type: string
        description: Owner of the component
        ui:field: OwnerPicker
        ui:options:
          catalogFilter:
            kind: Group
  - title: Choose a location
    required:
      - repoUrl
    properties:
      repoUrl:
        title: Repository Location
        type: string
        ui:field: RepoUrlPicker
        ui:options:
          allowedHosts:
            - github.com
steps:
  - id: fetch-base
    name: Fetch Base
    action: fetch:template
    input:
      url: ./template
      values:
        name: \${{parameters.name}}
`,Wt=(0,F.Z)(t=>({root:{gridArea:"pageContent",display:"grid",gridTemplateAreas:`
      "controls controls"
      "textArea preview"
    `,gridTemplateRows:"auto 1fr",gridTemplateColumns:"1fr 1fr"},controls:{gridArea:"controls",display:"flex",flexFlow:"row nowrap",alignItems:"center",margin:t.spacing(1)},textArea:{gridArea:"textArea"},preview:{gridArea:"preview"}})),Bt=({defaultPreviewTemplate:t=It,customFieldExtensions:a=[],onClose:l,layouts:s=[]})=>{const r=Wt(),i=(0,L.u)(L.l),c=(0,L.u)(I.Ah),[m,o]=(0,e.useState)(""),[p,E]=(0,e.useState)(),[f,u]=(0,e.useState)([]),[O,_]=(0,e.useState)(t),[v,D]=(0,e.useState)({}),{loading:C}=(0,ue.default)(()=>c.getEntities({filter:{kind:"template"},fields:["kind","metadata.namespace","metadata.name","metadata.title","spec.parameters","spec.steps","spec.output"]}).then(({items:g})=>u(g.map(Z=>{var B;return{label:(B=Z.metadata.title)!=null?B:(0,I.$3)(Z,{defaultKind:"template"}),value:Z}}))).catch(g=>i.post({message:`Error loading exisiting templates: ${g.message}`,severity:"error"})),[c]),d=(0,e.useCallback)(g=>{o(g),_(ae.ZP.stringify(g.spec))},[_]);return e.createElement(e.Fragment,null,C&&e.createElement(le.Z,null),e.createElement("main",{className:r.root},e.createElement("div",{className:r.controls},e.createElement(oe.Z,{variant:"outlined",size:"small",fullWidth:!0},e.createElement(se.Z,{id:"select-template-label"},"Load Existing Template"),e.createElement(ie.Z,{value:m,label:"Load Existing Template",labelId:"select-template-label",onChange:g=>d(g.target.value)},f.map((g,Z)=>e.createElement(k.Z,{key:Z,value:g.value},g.label)))),e.createElement(j.Z,{size:"medium",onClick:l},e.createElement(ge.Z,null))),e.createElement("div",{className:r.textArea},e.createElement(W.c,{content:O,onUpdate:_,errorText:p})),e.createElement("div",{className:r.preview},e.createElement(H,{data:v,onUpdate:D,content:O,contentIsSpec:!0,fieldExtensions:a,setErrorText:E,layouts:s}))))},Ut=(0,F.Z)(t=>({root:{gridArea:"pageContent",display:"grid",gridTemplateAreas:`
      "controls controls"
      "fieldForm preview"
    `,gridTemplateRows:"auto 1fr",gridTemplateColumns:"1fr 1fr"},controls:{gridArea:"controls",display:"flex",flexFlow:"row nowrap",alignItems:"center",margin:t.spacing(1)},fieldForm:{gridArea:"fieldForm"},preview:{gridArea:"preview"}})),Zt=({customFieldExtensions:t=[],onClose:a})=>{var l,s;const r=Ut(),i=t.filter(d=>!!d.schema),[c,m]=(0,e.useState)(i[0]),[o,p]=(0,e.useState)({}),[E,f]=(0,e.useState)(Date.now()),[u,O]=(0,e.useState)({}),_=(0,e.useMemo)(()=>{var d,g;return ae.ZP.stringify({parameters:[{title:`${c.name} Example`,properties:{[c.name]:{type:(g=(d=c.schema)==null?void 0:d.returnValue)==null?void 0:g.type,"ui:field":c.name,"ui:options":o}}}]})},[o,c]),v=(0,e.useMemo)(()=>Object.fromEntries(t.map(({name:d,component:g})=>[d,g])),[t]),D=(0,e.useCallback)(d=>{m(d),p({}),O({})},[p,m,O]),C=(0,e.useCallback)(d=>{p(d),f(Date.now())},[p,f]);return e.createElement("main",{className:r.root},e.createElement("div",{className:r.controls},e.createElement(oe.Z,{variant:"outlined",size:"small",fullWidth:!0},e.createElement(se.Z,{id:"select-field-label"},"Choose Custom Field Extension"),e.createElement(ie.Z,{value:c,label:"Choose Custom Field Extension",labelId:"select-field-label",onChange:d=>D(d.target.value)},i.map((d,g)=>e.createElement(k.Z,{key:g,value:d},d.name)))),e.createElement(j.Z,{size:"medium",onClick:a,"aria-label":"Close"},e.createElement(ge.Z,null))),e.createElement("div",{className:r.fieldForm},e.createElement(X.Z,null,e.createElement(ce.Z,{title:"Field Options"}),e.createElement(q.Z,null,e.createElement(fe.l0,{showErrorList:!1,fields:{...v},noHtml5Validate:!0,formData:o,formContext:{fieldFormState:o},onSubmit:d=>C(d.formData),validator:pe.ZP,schema:((l=c.schema)==null?void 0:l.uiOptions)||{},experimental_defaultFormStateBehavior:{allOf:"populateDefaults"}},e.createElement(z.Z,{variant:"contained",color:"primary",type:"submit",disabled:!((s=c.schema)!=null&&s.uiOptions)},"Apply"))))),e.createElement("div",{className:r.preview},e.createElement(X.Z,null,e.createElement(ce.Z,{title:"Example Template Spec"}),e.createElement(q.Z,null,e.createElement(Qe.ZP,{readOnly:!0,theme:"dark",height:"100%",extensions:[Je.il.define(Ge.r)],value:_}))),e.createElement(H,{data:u,onUpdate:O,key:E,content:_,contentIsSpec:!0,fieldExtensions:t,setErrorText:()=>null})))};function St(t){const[a,l]=(0,e.useState)();let s=null;return(a==null?void 0:a.type)==="local"?s=e.createElement(Lt,{directory:a.directory,fieldExtensions:t.customFieldExtensions,onClose:()=>l(void 0),layouts:t.layouts}):(a==null?void 0:a.type)==="form"?s=e.createElement(Bt,{defaultPreviewTemplate:t.defaultPreviewTemplate,customFieldExtensions:t.customFieldExtensions,onClose:()=>l(void 0),layouts:t.layouts}):(a==null?void 0:a.type)==="field-explorer"?s=e.createElement(Zt,{customFieldExtensions:t.customFieldExtensions,onClose:()=>l(void 0)}):s=e.createElement(h.VY,null,e.createElement(W.e,{onSelect:r=>{r==="local"?W.W.requestDirectoryAccess().then(i=>l({type:"local",directory:i})).catch(()=>{}):r==="form"?l({type:"form"}):r==="field-explorer"&&l({type:"field-explorer"})}})),e.createElement(h.T3,{themeId:"home"},e.createElement(h.h4,{title:"Template Editor",subtitle:"Edit, preview, and try out templates and template forms"}),s)}const xt=t=>{const{groups:a,templateFilter:l,components:s={},defaultPreviewTemplate:r}=t,{ReviewStepComponent:i,TemplateCardComponent:c,TaskPageComponent:m}=s,o=(0,M.pC)(),p=m!=null?m:W.g,E=(0,_e.PT)(o),f=[...E,...W.f.filter(({name:_})=>!E.some(v=>v.name===_))],u=(0,_e.zS)(o),O=()=>{const{templateName:_}=(0,R.Oi)(y.x),v=(0,R.tg)(y.o);return(0,e.useEffect)(()=>console.warn("The route /template/:templateName is deprecated, please use the new /template/:namespace/:templateName route instead"),[]),e.createElement(M.Fg,{to:v({namespace:"default",templateName:_})})};return e.createElement(M.Z5,null,e.createElement(M.AW,{path:"/",element:e.createElement(Et,{groups:a,templateFilter:l,TemplateCardComponent:c,contextMenu:t.contextMenu,headerOptions:t.headerOptions})}),e.createElement(M.AW,{path:y.x.path,element:e.createElement(O,null)}),e.createElement(M.AW,{path:y.o.path,element:e.createElement(V.S,null,e.createElement(Pt,{ReviewStepComponent:i,customFieldExtensions:f,layouts:u,headerOptions:t.headerOptions}))}),e.createElement(M.AW,{path:y.t.path,element:e.createElement(W.L,null)}),e.createElement(M.AW,{path:y.w.path,element:e.createElement(p,null)}),e.createElement(M.AW,{path:y.q.path,element:e.createElement(W.A,null)}),e.createElement(M.AW,{path:y.p.path,element:e.createElement(V.S,null,e.createElement(St,{defaultPreviewTemplate:r,customFieldExtensions:f,layouts:u}))}),e.createElement(M.AW,{path:"preview",element:e.createElement(M.Fg,{to:"../edit"})}))}}}]);})();

//# sourceMappingURL=1447.775acd89.chunk.js.map