{"version":3,"file":"index.esm.js","sources":["../src/entity/conditions.ts","../src/entity/constants.ts","../src/entity/policies/DefaultNamespaceEntityPolicy.ts","../src/entity/ref.ts","../src/entity/policies/GroupDefaultParentEntityPolicy.ts","../src/validation/CommonValidatorFunctions.ts","../src/validation/ajv.ts","../src/validation/entityEnvelopeSchemaValidator.ts","../src/validation/entityKindSchemaValidator.ts","../src/validation/entitySchemaValidator.ts","../src/validation/KubernetesValidatorFunctions.ts","../src/validation/makeValidator.ts","../src/entity/policies/FieldFormatEntityPolicy.ts","../src/entity/policies/NoForeignRootFieldsEntityPolicy.ts","../src/entity/policies/SchemaValidEntityPolicy.ts","../src/EntityPolicies.ts","../src/kinds/util.ts","../src/kinds/ApiEntityV1alpha1.ts","../src/kinds/ComponentEntityV1alpha1.ts","../src/kinds/DomainEntityV1alpha1.ts","../src/kinds/GroupEntityV1alpha1.ts","../src/kinds/LocationEntityV1alpha1.ts","../src/kinds/relations.ts","../src/kinds/ResourceEntityV1alpha1.ts","../src/kinds/SystemEntityV1alpha1.ts","../src/kinds/UserEntityV1alpha1.ts","../src/location/annotation.ts","../src/location/helpers.ts"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ApiEntity,\n  ComponentEntity,\n  DomainEntity,\n  GroupEntity,\n  LocationEntity,\n  ResourceEntity,\n  SystemEntity,\n  UserEntity,\n} from '../kinds';\nimport { Entity } from './Entity';\n\n/**\n * @public\n */\nexport function isApiEntity(entity: Entity): entity is ApiEntity {\n  return entity.kind.toLocaleUpperCase('en-US') === 'API';\n}\n/**\n * @public\n */\nexport function isComponentEntity(entity: Entity): entity is ComponentEntity {\n  return entity.kind.toLocaleUpperCase('en-US') === 'COMPONENT';\n}\n/**\n * @public\n */\nexport function isDomainEntity(entity: Entity): entity is DomainEntity {\n  return entity.kind.toLocaleUpperCase('en-US') === 'DOMAIN';\n}\n/**\n * @public\n */\nexport function isGroupEntity(entity: Entity): entity is GroupEntity {\n  return entity.kind.toLocaleUpperCase('en-US') === 'GROUP';\n}\n/**\n * @public\n */\nexport function isLocationEntity(entity: Entity): entity is LocationEntity {\n  return entity.kind.toLocaleUpperCase('en-US') === 'LOCATION';\n}\n/**\n * @public\n */\nexport function isResourceEntity(entity: Entity): entity is ResourceEntity {\n  return entity.kind.toLocaleUpperCase('en-US') === 'RESOURCE';\n}\n/**\n * @public\n */\nexport function isSystemEntity(entity: Entity): entity is SystemEntity {\n  return entity.kind.toLocaleUpperCase('en-US') === 'SYSTEM';\n}\n/**\n * @public\n */\nexport function isUserEntity(entity: Entity): entity is UserEntity {\n  return entity.kind.toLocaleUpperCase('en-US') === 'USER';\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * The namespace that entities without an explicit namespace fall into.\n *\n * @public\n */\nexport const DEFAULT_NAMESPACE = 'default';\n\n/**\n * Annotation for linking to entity page from catalog pages.\n *\n * @public\n */\nexport const ANNOTATION_VIEW_URL = 'backstage.io/view-url';\n\n/**\n * Annotation for linking to entity edit page from catalog pages.\n *\n * @public\n */\nexport const ANNOTATION_EDIT_URL = 'backstage.io/edit-url';\n\n/**\n * Annotation for specifying the API server of a Kubernetes cluster\n *\n * @deprecated Import this constant from `@backstage/plugin-kubernetes-common` instead\n * @public\n */\nexport const ANNOTATION_KUBERNETES_API_SERVER = 'kubernetes.io/api-server';\n\n/**\n * Annotation for specifying the Certificate Authority of an API server for a Kubernetes cluster\n *\n * @deprecated Import this constant from `@backstage/plugin-kubernetes-common` instead\n * @public\n */\nexport const ANNOTATION_KUBERNETES_API_SERVER_CA =\n  'kubernetes.io/api-server-certificate-authority';\n\n/**\n * Annotation for specifying the auth provider for a Kubernetes cluster\n *\n * @deprecated Import this constant from `@backstage/plugin-kubernetes-common` instead\n * @public\n */\nexport const ANNOTATION_KUBERNETES_AUTH_PROVIDER =\n  'kubernetes.io/auth-provider';\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport lodash from 'lodash';\nimport { EntityPolicy } from './types';\nimport { DEFAULT_NAMESPACE } from '../constants';\nimport { Entity } from '../Entity';\n\n/**\n * Sets a default namespace if none was set.\n *\n * @public\n */\nexport class DefaultNamespaceEntityPolicy implements EntityPolicy {\n  private readonly namespace: string;\n\n  constructor(namespace: string = DEFAULT_NAMESPACE) {\n    this.namespace = namespace;\n  }\n\n  async enforce(entity: Entity): Promise<Entity> {\n    if (entity.metadata.namespace) {\n      return entity;\n    }\n\n    return lodash.merge({ metadata: { namespace: this.namespace } }, entity);\n  }\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DEFAULT_NAMESPACE } from './constants';\nimport { CompoundEntityRef } from '../types';\nimport { Entity } from './Entity';\n\nfunction parseRefString(ref: string): {\n  kind?: string;\n  namespace?: string;\n  name: string;\n} {\n  let colonI = ref.indexOf(':');\n  const slashI = ref.indexOf('/');\n\n  // If the / is ahead of the :, treat the rest as the name\n  if (slashI !== -1 && slashI < colonI) {\n    colonI = -1;\n  }\n\n  const kind = colonI === -1 ? undefined : ref.slice(0, colonI);\n  const namespace = slashI === -1 ? undefined : ref.slice(colonI + 1, slashI);\n  const name = ref.slice(Math.max(colonI + 1, slashI + 1));\n\n  if (kind === '' || namespace === '' || name === '') {\n    throw new TypeError(\n      `Entity reference \"${ref}\" was not on the form [<kind>:][<namespace>/]<name>`,\n    );\n  }\n\n  return { kind, namespace, name };\n}\n\n/**\n * Extracts the kind, namespace and name that form the compound entity ref\n * triplet of the given entity.\n *\n * @public\n * @param entity - An entity\n * @returns The compound entity ref\n */\nexport function getCompoundEntityRef(entity: Entity): CompoundEntityRef {\n  return {\n    kind: entity.kind,\n    namespace: entity.metadata.namespace || DEFAULT_NAMESPACE,\n    name: entity.metadata.name,\n  };\n}\n\n/**\n * Parses an entity reference, either on string or compound form, and returns\n * a structure with a name, and optional kind and namespace.\n *\n * @remarks\n *\n * The context object can contain default values for the kind and namespace,\n * that will be used if the input reference did not specify any.\n *\n * @public\n * @param ref - The reference to parse\n * @param context - The context of defaults that the parsing happens within\n * @returns The compound form of the reference\n */\nexport function parseEntityRef(\n  ref: string | { kind?: string; namespace?: string; name: string },\n  context?: {\n    /** The default kind, if none is given in the reference */\n    defaultKind?: string;\n    /** The default namespace, if none is given in the reference */\n    defaultNamespace?: string;\n  },\n): CompoundEntityRef {\n  if (!ref) {\n    throw new Error(`Entity reference must not be empty`);\n  }\n\n  const defaultKind = context?.defaultKind;\n  const defaultNamespace = context?.defaultNamespace || DEFAULT_NAMESPACE;\n\n  let kind: string | undefined;\n  let namespace: string | undefined;\n  let name: string | undefined;\n\n  if (typeof ref === 'string') {\n    const parsed = parseRefString(ref);\n    kind = parsed.kind ?? defaultKind;\n    namespace = parsed.namespace ?? defaultNamespace;\n    name = parsed.name;\n  } else {\n    kind = ref.kind ?? defaultKind;\n    namespace = ref.namespace ?? defaultNamespace;\n    name = ref.name;\n  }\n\n  if (!kind) {\n    const textual = JSON.stringify(ref);\n    throw new Error(\n      `Entity reference ${textual} had missing or empty kind (e.g. did not start with \"component:\" or similar)`,\n    );\n  } else if (!namespace) {\n    const textual = JSON.stringify(ref);\n    throw new Error(\n      `Entity reference ${textual} had missing or empty namespace`,\n    );\n  } else if (!name) {\n    const textual = JSON.stringify(ref);\n    throw new Error(`Entity reference ${textual} had missing or empty name`);\n  }\n\n  return { kind, namespace, name };\n}\n\n/**\n * Takes an entity or entity name/reference, and returns the string form of an\n * entity ref.\n *\n * @remarks\n *\n * This function creates a canonical and unique reference to the entity, converting\n * all parts of the name to lowercase and inserts the default namespace if needed.\n * It is typically not the best way to represent the entity reference to the user.\n *\n * @public\n * @param ref - The reference to serialize\n * @returns The same reference on either string or compound form\n */\nexport function stringifyEntityRef(\n  ref: Entity | { kind: string; namespace?: string; name: string },\n): string {\n  let kind;\n  let namespace;\n  let name;\n\n  if ('metadata' in ref) {\n    kind = ref.kind;\n    namespace = ref.metadata.namespace ?? DEFAULT_NAMESPACE;\n    name = ref.metadata.name;\n  } else {\n    kind = ref.kind;\n    namespace = ref.namespace ?? DEFAULT_NAMESPACE;\n    name = ref.name;\n  }\n\n  return `${kind.toLocaleLowerCase('en-US')}:${namespace.toLocaleLowerCase(\n    'en-US',\n  )}/${name.toLocaleLowerCase('en-US')}`;\n}\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Entity } from '../Entity';\nimport { GroupEntity } from '../../kinds';\nimport { EntityPolicy } from './types';\nimport { DEFAULT_NAMESPACE } from '../constants';\nimport { parseEntityRef, stringifyEntityRef } from '../ref';\n\n/**\n * DefaultParentPolicy is an EntityPolicy that updates group entities\n * with a parent of last resort. This ensures that, while we preserve\n * any existing group hierarchies, we can guarantee that there is a\n * single global root of the group hierarchy.\n *\n * @public\n */\nexport class GroupDefaultParentEntityPolicy implements EntityPolicy {\n  private readonly parentRef: string;\n\n  constructor(parentEntityRef: string) {\n    const { kind, namespace, name } = parseEntityRef(parentEntityRef, {\n      defaultKind: 'Group',\n      defaultNamespace: DEFAULT_NAMESPACE,\n    });\n\n    if (kind.toLocaleUpperCase('en-US') !== 'GROUP') {\n      throw new TypeError('group parent must be a group');\n    }\n\n    this.parentRef = stringifyEntityRef({\n      kind: kind,\n      namespace: namespace,\n      name: name,\n    });\n  }\n\n  async enforce(entity: Entity): Promise<Entity> {\n    if (entity.kind !== 'Group') {\n      return entity;\n    }\n\n    const group = entity as GroupEntity;\n    if (group.spec.parent) {\n      return group;\n    }\n\n    // Avoid making the parent entity it's own parent.\n    if (stringifyEntityRef(group) !== this.parentRef) {\n      group.spec.parent = this.parentRef;\n    }\n\n    return group;\n  }\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport lodash from 'lodash';\n\n/**\n * Contains various helper validation and normalization functions that can be\n * composed to form a Validator.\n *\n * @public\n */\nexport class CommonValidatorFunctions {\n  /**\n   * Checks that the value is on the form `<suffix>` or `<prefix><separator><suffix>`, and validates\n   * those parts separately.\n   *\n   * @param value - The value to check\n   * @param separator - The separator between parts\n   * @param isValidPrefix - Checks that the part before the separator is valid, if present\n   * @param isValidSuffix - Checks that the part after the separator (or the entire value if there is no separator) is valid\n   */\n  static isValidPrefixAndOrSuffix(\n    value: unknown,\n    separator: string,\n    isValidPrefix: (value: string) => boolean,\n    isValidSuffix: (value: string) => boolean,\n  ): boolean {\n    if (typeof value !== 'string') {\n      return false;\n    }\n\n    const parts = value.split(separator);\n    if (parts.length === 1) {\n      return isValidSuffix(parts[0]);\n    } else if (parts.length === 2) {\n      return isValidPrefix(parts[0]) && isValidSuffix(parts[1]);\n    }\n\n    return false;\n  }\n\n  /**\n   * Checks that the value can be safely transferred as JSON.\n   *\n   * @param value - The value to check\n   */\n  static isJsonSafe(value: unknown): boolean {\n    try {\n      return lodash.isEqual(value, JSON.parse(JSON.stringify(value)));\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * Checks that the value is a valid DNS subdomain name.\n   *\n   * @param value - The value to check\n   * @see https://tools.ietf.org/html/rfc1123\n   */\n  static isValidDnsSubdomain(value: unknown): boolean {\n    return (\n      typeof value === 'string' &&\n      value.length >= 1 &&\n      value.length <= 253 &&\n      value.split('.').every(CommonValidatorFunctions.isValidDnsLabel)\n    );\n  }\n\n  /**\n   * Checks that the value is a valid DNS label.\n   *\n   * @param value - The value to check\n   * @see https://tools.ietf.org/html/rfc1123\n   */\n  static isValidDnsLabel(value: unknown): boolean {\n    return (\n      typeof value === 'string' &&\n      value.length >= 1 &&\n      value.length <= 63 &&\n      /^[a-z0-9]+(?:\\-+[a-z0-9]+)*$/.test(value)\n    );\n  }\n\n  /**\n   * Checks that the value is a valid tag.\n   *\n   * @deprecated This will be removed in a future release\n   * @param value - The value to check\n   */\n  static isValidTag(value: unknown): boolean {\n    return (\n      typeof value === 'string' &&\n      value.length >= 1 &&\n      value.length <= 63 &&\n      /^[a-z0-9+#]+(\\-[a-z0-9+#]+)*$/.test(value)\n    );\n  }\n\n  /**\n   * Checks that the value is a valid string URL.\n   *\n   * @param value - The value to check\n   */\n  static isValidUrl(value: unknown): boolean {\n    if (typeof value !== 'string') {\n      return false;\n    }\n\n    try {\n      // eslint-disable-next-line no-new\n      new URL(value);\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * Checks that the value is a non empty string value.\n   *\n   * @deprecated use isNonEmptyString instead\n   * @param value - The value to check\n   */\n  static isValidString(value: unknown): boolean {\n    return typeof value === 'string' && value?.trim()?.length >= 1;\n  }\n\n  /**\n   * Checks that the value is a string value that's not empty.\n   *\n   * @param value - The value to check\n   */\n  static isNonEmptyString(value: unknown): value is string {\n    return typeof value === 'string' && value?.trim()?.length >= 1;\n  }\n}\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Ajv, { Schema, ValidateFunction } from 'ajv';\nimport entitySchema from '../schema/Entity.schema.json';\nimport entityEnvelopeSchema from '../schema/EntityEnvelope.schema.json';\nimport entityMetaSchema from '../schema/EntityMeta.schema.json';\nimport commonSchema from '../schema/shared/common.schema.json';\n\n// A local cache of compiled schemas, to avoid duplicate work.\n// The keys are JSON stringified versions of the schema\nconst compiledSchemaCache = new Map<string, ValidateFunction<unknown>>();\n\n// The core schemas that others can depend on\nconst refDependencyCandidates = [\n  entityEnvelopeSchema,\n  entitySchema,\n  entityMetaSchema,\n  commonSchema,\n];\n\nexport function throwAjvError(\n  errors: ValidateFunction<unknown>['errors'],\n): never {\n  if (!errors?.length) {\n    throw new TypeError('Unknown error');\n  }\n\n  const error = errors[0];\n  throw new TypeError(\n    `${error.instancePath || '<root>'} ${error.message}${\n      error.params\n        ? ` - ${Object.entries(error.params)\n            .map(([key, val]) => `${key}: ${val}`)\n            .join(', ')}`\n        : ''\n    }`,\n  );\n}\n\n// Compiles the given schema, and makes sure to also grab any core dependencies\n// that it depends on\nexport function compileAjvSchema(\n  schema: Schema,\n  options: { disableCache?: boolean } = {},\n): ValidateFunction<unknown> {\n  const disableCache = options?.disableCache ?? false;\n  const cacheKey = disableCache ? '' : JSON.stringify(schema);\n\n  if (!disableCache) {\n    const cached = compiledSchemaCache.get(cacheKey);\n    if (cached) {\n      return cached;\n    }\n  }\n\n  const extraSchemas = getExtraSchemas(schema);\n  const ajv = new Ajv({\n    allowUnionTypes: true,\n    allErrors: true,\n    validateSchema: true,\n  });\n  if (extraSchemas.length) {\n    ajv.addSchema(extraSchemas, undefined, undefined, true);\n  }\n  const compiled = ajv.compile(schema);\n\n  if (!disableCache) {\n    compiledSchemaCache.set(cacheKey, compiled);\n  }\n\n  return compiled;\n}\n\n// Find refs in the given schema and recursively in all known schemas it\n// targets, collecting that list of schemas as we go\nfunction getExtraSchemas(schema: Schema): Schema[] {\n  if (typeof schema !== 'object') {\n    return [];\n  }\n\n  const seen = new Set<string>();\n  if (schema.$id) {\n    seen.add(schema.$id);\n  }\n\n  const selected = new Array<Schema>();\n\n  const todo: Schema[] = [schema];\n  while (todo.length) {\n    const current = todo.pop()!;\n\n    for (const ref of getAllRefs(current)) {\n      if (!seen.has(ref)) {\n        seen.add(ref);\n\n        const match = refDependencyCandidates.find(c => c.$id === ref);\n        if (match) {\n          selected.push(match);\n          todo.push(match);\n        }\n      }\n    }\n  }\n\n  return selected;\n}\n\n// Naively step through the entire schema looking for \"$ref\": \"x\" pairs. The\n// resulting iterator may contain duplicates. Ignores fragments, i.e. for a ref\n// of \"a#b\", it will just yield \"a\".\nfunction* getAllRefs(schema: Schema): Iterable<string> {\n  const todo: any[] = [schema];\n  while (todo.length) {\n    const current = todo.pop()!;\n    if (typeof current === 'object' && current) {\n      for (const [key, value] of Object.entries(current)) {\n        if (key === '$ref' && typeof value === 'string') {\n          yield value.split('#')[0];\n        } else {\n          todo.push(value);\n        }\n      }\n    }\n  }\n}\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Schema } from 'ajv';\nimport { EntityEnvelope } from '../entity/EntityEnvelope';\nimport entityEnvelopeSchema from '../schema/EntityEnvelope.schema.json';\nimport { compileAjvSchema, throwAjvError } from './ajv';\n\n/**\n * Creates a validation function that takes some arbitrary data, and either\n * returns that data cast to an {@link EntityEnvelope} (or the given subtype)\n * if it matches that schema, or throws a {@link globals#TypeError} describing the\n * errors.\n *\n * @remarks\n *\n * Note that this validator is only meant for applying the base schema checks;\n * it does not take custom policies or additional processor based validation\n * into account.\n *\n * By default, the plain `EntityEnvelope` schema is used. If you pass in your\n * own, it may contain `$ref` references to the following, which are resolved\n * automatically for you:\n *\n * - {@link EntityEnvelope}\n * - {@link Entity}\n * - {@link EntityMeta}\n * - `common#<id>`\n *\n * See also {@link https://github.com/backstage/backstage/tree/master/packages/catalog-model/src/schema}\n *\n * @public\n *\n */\nexport function entityEnvelopeSchemaValidator<\n  T extends EntityEnvelope = EntityEnvelope,\n>(schema?: unknown): (data: unknown) => T {\n  const validate = compileAjvSchema(\n    schema ? (schema as Schema) : entityEnvelopeSchema,\n  );\n\n  return data => {\n    const result = validate(data);\n    if (result === true) {\n      return data as T;\n    }\n\n    throw throwAjvError(validate.errors);\n  };\n}\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Schema } from 'ajv';\nimport { Entity } from '../entity';\nimport { compileAjvSchema, throwAjvError } from './ajv';\n\n/**\n * Creates a validation function that takes some arbitrary data, and either\n * returns that data cast to a `T` if it matches that schema, or `false` if the\n * schema apiVersion/kind didn't apply to that data, or throws a\n * {@link globals#TypeError} describing actual errors.\n *\n * @remarks\n *\n * This validator is highly specialized, in that it has special treatment of\n * the `kind` and `apiVersion` root keys. This only works if your schema has\n * their rule set to `\"enum\"`:\n *\n * ```\n * \"apiVersion\": {\n *    \"enum\": [\"backstage.io/v1alpha1\", \"backstage.io/v1beta1\"]\n * },\n * \"kind\": {\n *   \"enum\": [\"Group\"]\n * },\n * ```\n *\n * In the above example, the created validator will return `false` if and only\n * if the kind and/or apiVersion mismatch.\n *\n * Note that this validator is only meant for applying the base schema checks;\n * it does not take custom policies or additional processor based validation\n * into account.\n *\n * The given schema may contain `$ref` references to the following, which are\n * resolved automatically for you:\n *\n * - {@link Entity}\n *\n * - {@link EntityEnvelope}\n *\n * - {@link EntityMeta}\n *\n * - `common#<id>`\n * @see {@link https://github.com/backstage/backstage/tree/master/packages/catalog-model/src/schema}\n *\n * @public\n */\nexport function entityKindSchemaValidator<T extends Entity>(\n  schema: unknown,\n): (data: unknown) => T | false {\n  const validate = compileAjvSchema(schema as Schema);\n\n  return data => {\n    const result = validate(data);\n    if (result === true) {\n      return data as T;\n    }\n\n    // Only in the case where kind and/or apiVersion have enum mismatches AND\n    // have NO other errors, we call it a soft error.\n    const softCandidates = validate.errors?.filter(e =>\n      ['/kind', '/apiVersion'].includes(e.instancePath),\n    );\n    if (\n      softCandidates?.length &&\n      softCandidates.every(e => e.keyword === 'enum')\n    ) {\n      return false;\n    }\n\n    throw throwAjvError(validate.errors);\n  };\n}\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Schema } from 'ajv';\nimport { Entity } from '../entity/Entity';\nimport entitySchema from '../schema/Entity.schema.json';\nimport { compileAjvSchema, throwAjvError } from './ajv';\n\n/**\n * Creates a validation function that takes some arbitrary data, and either\n * returns that data cast to an {@link Entity} (or the given subtype) if it\n * matches that schema, or throws a {@link globals#TypeError} describing the errors.\n *\n * @remarks\n *\n * Note that this validator is only meant for applying the base schema checks;\n * it does not take custom policies or additional processor based validation\n * into account.\n *\n * By default, the plain {@link Entity} schema is used. If you pass in your own, it\n * may contain `$ref` references to the following, which are resolved\n * automatically for you:\n *\n * - {@link Entity}\n * - {@link EntityEnvelope}\n * - {@link EntityMeta}\n * - `common#<id>`\n *\n * @public\n * @see {@link https://github.com/backstage/backstage/tree/master/packages/catalog-model/src/schema}\n */\nexport function entitySchemaValidator<T extends Entity = Entity>(\n  schema?: unknown,\n): (data: unknown) => T {\n  const validate = compileAjvSchema(schema ? (schema as Schema) : entitySchema);\n\n  return data => {\n    const result = validate(data);\n    if (result === true) {\n      return data as T;\n    }\n\n    throw throwAjvError(validate.errors);\n  };\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommonValidatorFunctions } from './CommonValidatorFunctions';\n\n/**\n * Contains validation functions that match the Kubernetes spec, usable to\n * build a catalog that is compatible with those rule sets.\n *\n * @public\n * @see https://kubernetes.io/docs/concepts/overview/working-with-objects/names/\n * @see https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#syntax-and-character-set\n * @see https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/#syntax-and-character-set\n */\nexport class KubernetesValidatorFunctions {\n  static isValidApiVersion(value: unknown): boolean {\n    return CommonValidatorFunctions.isValidPrefixAndOrSuffix(\n      value,\n      '/',\n      CommonValidatorFunctions.isValidDnsSubdomain,\n      n => n.length >= 1 && n.length <= 63 && /^[a-z0-9A-Z]+$/.test(n),\n    );\n  }\n\n  static isValidKind(value: unknown): boolean {\n    return (\n      typeof value === 'string' &&\n      value.length >= 1 &&\n      value.length <= 63 &&\n      /^[a-zA-Z][a-z0-9A-Z]*$/.test(value)\n    );\n  }\n\n  static isValidObjectName(value: unknown): boolean {\n    return (\n      typeof value === 'string' &&\n      value.length >= 1 &&\n      value.length <= 63 &&\n      /^([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9]$/.test(value)\n    );\n  }\n\n  static isValidNamespace(value: unknown): boolean {\n    return CommonValidatorFunctions.isValidDnsLabel(value);\n  }\n\n  static isValidLabelKey(value: unknown): boolean {\n    return CommonValidatorFunctions.isValidPrefixAndOrSuffix(\n      value,\n      '/',\n      CommonValidatorFunctions.isValidDnsSubdomain,\n      KubernetesValidatorFunctions.isValidObjectName,\n    );\n  }\n\n  static isValidLabelValue(value: unknown): boolean {\n    return (\n      value === '' || KubernetesValidatorFunctions.isValidObjectName(value)\n    );\n  }\n\n  static isValidAnnotationKey(value: unknown): boolean {\n    return CommonValidatorFunctions.isValidPrefixAndOrSuffix(\n      value,\n      '/',\n      CommonValidatorFunctions.isValidDnsSubdomain,\n      KubernetesValidatorFunctions.isValidObjectName,\n    );\n  }\n\n  static isValidAnnotationValue(value: unknown): boolean {\n    return typeof value === 'string';\n  }\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { KubernetesValidatorFunctions } from './KubernetesValidatorFunctions';\nimport { Validators } from './types';\n\nconst defaultValidators: Validators = {\n  isValidApiVersion: KubernetesValidatorFunctions.isValidApiVersion,\n  isValidKind: KubernetesValidatorFunctions.isValidKind,\n  isValidEntityName: KubernetesValidatorFunctions.isValidObjectName,\n  isValidNamespace: KubernetesValidatorFunctions.isValidNamespace,\n  isValidLabelKey: KubernetesValidatorFunctions.isValidLabelKey,\n  isValidLabelValue: KubernetesValidatorFunctions.isValidLabelValue,\n  isValidAnnotationKey: KubernetesValidatorFunctions.isValidAnnotationKey,\n  isValidAnnotationValue: KubernetesValidatorFunctions.isValidAnnotationValue,\n  isValidTag: (value: unknown): boolean => {\n    // NOTE(freben): This one is a bit of an oddball and doesn't fit well anywhere to delegate to, so it's just inlined for now.\n    return (\n      typeof value === 'string' &&\n      value.length >= 1 &&\n      value.length <= 63 &&\n      /^[a-z0-9:+#]+(\\-[a-z0-9:+#]+)*$/.test(value)\n    );\n  },\n};\n\n/**\n * Creates a {@link Validators} object from `overrides`, with default values taken from {@link KubernetesValidatorFunctions}\n *\n * @public\n */\nexport function makeValidator(overrides: Partial<Validators> = {}): Validators {\n  return {\n    ...defaultValidators,\n    ...overrides,\n  };\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { EntityPolicy } from './types';\nimport {\n  CommonValidatorFunctions,\n  KubernetesValidatorFunctions,\n  makeValidator,\n  Validators,\n} from '../../validation';\nimport { Entity } from '../Entity';\n\n/**\n * Ensures that the format of individual fields of the entity envelope\n * is valid.\n *\n * @remarks\n *\n * This does not take into account machine generated fields such as uid and etag.\n *\n * @public\n */\nexport class FieldFormatEntityPolicy implements EntityPolicy {\n  private readonly validators: Validators;\n\n  constructor(validators: Validators = makeValidator()) {\n    this.validators = validators;\n  }\n\n  async enforce(entity: Entity): Promise<Entity> {\n    function require(\n      field: string,\n      value: any,\n      validator: (value: any) => boolean,\n    ) {\n      if (value === undefined || value === null) {\n        throw new Error(`${field} must have a value`);\n      }\n\n      let isValid: boolean;\n      try {\n        isValid = validator(value);\n      } catch (e) {\n        throw new Error(`${field} could not be validated, ${e}`);\n      }\n\n      if (!isValid) {\n        let expectation;\n        switch (\n          validator.name as\n            | keyof typeof KubernetesValidatorFunctions\n            | keyof typeof CommonValidatorFunctions\n        ) {\n          case 'isValidLabelValue':\n          case 'isValidObjectName':\n            expectation =\n              'a string that is sequences of [a-zA-Z0-9] separated by any of [-_.], at most 63 characters in total';\n            break;\n          case 'isValidLabelKey':\n          case 'isValidApiVersion':\n          case 'isValidAnnotationKey':\n            expectation = 'a valid prefix and/or suffix';\n            break;\n          case 'isValidNamespace':\n          case 'isValidDnsLabel':\n            expectation =\n              'a string that is sequences of [a-z0-9] separated by [-], at most 63 characters in total';\n            break;\n          case 'isValidTag':\n            expectation =\n              'a string that is sequences of [a-z0-9+#] separated by [-], at most 63 characters in total';\n            break;\n          case 'isValidAnnotationValue':\n            expectation = 'a string';\n            break;\n          case 'isValidKind':\n            expectation =\n              'a string that is a sequence of [a-zA-Z][a-z0-9A-Z], at most 63 characters in total';\n            break;\n          case 'isValidUrl':\n            expectation = 'a string that is a valid url';\n            break;\n          case 'isValidString':\n          case 'isNonEmptyString':\n            expectation = 'a non empty string';\n            break;\n          default:\n            expectation = undefined;\n            break;\n        }\n\n        // ensure that if there are other/future validators, the error message defaults to a general \"is not valid, visit link\"\n        const message = expectation\n          ? ` expected ${expectation} but found \"${value}\".`\n          : '';\n\n        throw new Error(\n          `\"${field}\" is not valid;${message} To learn more about catalog file format, visit: https://github.com/backstage/backstage/blob/master/docs/architecture-decisions/adr002-default-catalog-file-format.md`,\n        );\n      }\n    }\n\n    function optional(\n      field: string,\n      value: any,\n      validator: (value: any) => boolean,\n    ) {\n      return value === undefined || require(field, value, validator);\n    }\n\n    require('apiVersion', entity.apiVersion, this.validators.isValidApiVersion);\n    require('kind', entity.kind, this.validators.isValidKind);\n\n    require('metadata.name', entity.metadata.name, this.validators\n      .isValidEntityName);\n    optional(\n      'metadata.namespace',\n      entity.metadata.namespace,\n      this.validators.isValidNamespace,\n    );\n\n    for (const [k, v] of Object.entries(entity.metadata.labels ?? [])) {\n      require(`labels.${k}`, k, this.validators.isValidLabelKey);\n      require(`labels.${k}`, v, this.validators.isValidLabelValue);\n    }\n\n    for (const [k, v] of Object.entries(entity.metadata.annotations ?? [])) {\n      require(`annotations.${k}`, k, this.validators.isValidAnnotationKey);\n      require(`annotations.${k}`, v, this.validators.isValidAnnotationValue);\n    }\n\n    const tags = entity.metadata.tags ?? [];\n\n    for (let i = 0; i < tags.length; ++i) {\n      require(`tags.${i}`, tags[i], this.validators.isValidTag);\n    }\n\n    const links = entity.metadata.links ?? [];\n\n    for (let i = 0; i < links.length; ++i) {\n      require(`links.${i}.url`, links[i]\n        ?.url, CommonValidatorFunctions.isValidUrl);\n      optional(\n        `links.${i}.title`,\n        links[i]?.title,\n        CommonValidatorFunctions.isNonEmptyString,\n      );\n      optional(\n        `links.${i}.icon`,\n        links[i]?.icon,\n        KubernetesValidatorFunctions.isValidObjectName,\n      );\n    }\n\n    return entity;\n  }\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { EntityPolicy } from './types';\nimport { Entity } from '../Entity';\n\nconst defaultKnownFields = ['apiVersion', 'kind', 'metadata', 'spec'];\n\n/**\n * Ensures that there are no foreign root fields in the entity.\n *\n * @public\n */\nexport class NoForeignRootFieldsEntityPolicy implements EntityPolicy {\n  private readonly knownFields: string[];\n\n  constructor(knownFields: string[] = defaultKnownFields) {\n    this.knownFields = knownFields;\n  }\n\n  async enforce(entity: Entity): Promise<Entity> {\n    for (const field of Object.keys(entity)) {\n      if (!this.knownFields.includes(field)) {\n        throw new Error(`Unknown field ${field}`);\n      }\n    }\n    return entity;\n  }\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Ajv, { ValidateFunction } from 'ajv';\nimport entitySchema from '../../schema/Entity.schema.json';\nimport entityMetaSchema from '../../schema/EntityMeta.schema.json';\nimport commonSchema from '../../schema/shared/common.schema.json';\nimport { Entity } from '../Entity';\nimport { EntityPolicy } from './types';\n\n/**\n * Ensures that the entity spec is valid according to a schema.\n *\n * @remarks\n *\n * This should be the first policy in the list, to ensure that other downstream\n * policies can work with a structure that is at least valid in therms of the\n * typescript type.\n *\n * @public\n */\nexport class SchemaValidEntityPolicy implements EntityPolicy {\n  private validate: ValidateFunction<Entity> | undefined;\n\n  async enforce(entity: Entity): Promise<Entity> {\n    if (!this.validate) {\n      const ajv = new Ajv({ allowUnionTypes: true });\n      this.validate = ajv\n        .addSchema([commonSchema, entityMetaSchema], undefined, undefined, true)\n        .compile<Entity>(entitySchema);\n    }\n\n    const result = this.validate(entity);\n    if (result === true) {\n      return entity;\n    }\n\n    const [error] = this.validate.errors || [];\n    if (!error) {\n      throw new Error(`Malformed envelope, Unknown error`);\n    }\n\n    throw new Error(\n      `Malformed envelope, ${error.instancePath || '<root>'} ${error.message}`,\n    );\n  }\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Entity, EntityPolicy } from './entity';\n\n// Helper that requires that all of a set of policies can be successfully\n// applied\nclass AllEntityPolicies implements EntityPolicy {\n  constructor(private readonly policies: EntityPolicy[]) {}\n\n  async enforce(entity: Entity): Promise<Entity> {\n    let result = entity;\n    for (const policy of this.policies) {\n      const output = await policy.enforce(result);\n      if (!output) {\n        throw new Error(\n          `Policy ${policy.constructor.name} did not return a result`,\n        );\n      }\n      result = output;\n    }\n    return result;\n  }\n}\n\n// Helper that requires that at least one of a set of policies can be\n// successfully applied\nclass AnyEntityPolicy implements EntityPolicy {\n  constructor(private readonly policies: EntityPolicy[]) {}\n\n  async enforce(entity: Entity): Promise<Entity> {\n    for (const policy of this.policies) {\n      const output = await policy.enforce(entity);\n      if (output) {\n        return output;\n      }\n    }\n    throw new Error(`The entity did not match any known policy`);\n  }\n}\n\n/**\n * Provides helpers for enforcing a set of {@link EntityPolicy} in an `and`/`or` expression.\n *\n * @public\n */\nexport const EntityPolicies = {\n  allOf(policies: EntityPolicy[]): EntityPolicy {\n    return new AllEntityPolicies(policies);\n  },\n  oneOf(policies: EntityPolicy[]): EntityPolicy {\n    return new AnyEntityPolicy(policies);\n  },\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { entityKindSchemaValidator } from '../validation';\nimport { KindValidator } from './types';\n\n// TODO(freben): Left here as a compatibility helper. It would be nicer to\n// just export the inner validator directly. However, all of the already\n// exported kind validators have the `KindValidator` signature which is\n// different. So let's postpone that change until a later time.\nexport function ajvCompiledJsonSchemaValidator(schema: unknown): KindValidator {\n  let validator: undefined | ((data: unknown) => any);\n  return {\n    async check(data) {\n      if (!validator) {\n        validator = entityKindSchemaValidator(schema);\n      }\n      return validator(data) === data;\n    },\n  };\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Entity } from '../entity/Entity';\nimport schema from '../schema/kinds/API.v1alpha1.schema.json';\nimport { ajvCompiledJsonSchemaValidator } from './util';\n\n/**\n * Backstage API kind Entity. APIs describe the interfaces for Components to communicate.\n *\n * @remarks\n *\n * See {@link https://backstage.io/docs/features/software-catalog/system-model}\n *\n * @public\n */\nexport interface ApiEntityV1alpha1 extends Entity {\n  apiVersion: 'backstage.io/v1alpha1' | 'backstage.io/v1beta1';\n  kind: 'API';\n  spec: {\n    type: string;\n    lifecycle: string;\n    owner: string;\n    definition: string;\n    system?: string;\n  };\n}\n\n/**\n * {@link KindValidator} for {@link ApiEntityV1alpha1}.\n *\n * @public\n */\nexport const apiEntityV1alpha1Validator =\n  ajvCompiledJsonSchemaValidator(schema);\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Entity } from '../entity/Entity';\nimport schema from '../schema/kinds/Component.v1alpha1.schema.json';\nimport { ajvCompiledJsonSchemaValidator } from './util';\n\n/**\n * Backstage catalog Component kind Entity. Represents a single, individual piece of software.\n *\n * @remarks\n *\n * See {@link https://backstage.io/docs/features/software-catalog/system-model}\n *\n * @public\n */\nexport interface ComponentEntityV1alpha1 extends Entity {\n  apiVersion: 'backstage.io/v1alpha1' | 'backstage.io/v1beta1';\n  kind: 'Component';\n  spec: {\n    type: string;\n    lifecycle: string;\n    owner: string;\n    subcomponentOf?: string;\n    providesApis?: string[];\n    consumesApis?: string[];\n    dependsOn?: string[];\n    system?: string;\n  };\n}\n\n/**\n * {@link KindValidator} for {@link ComponentEntityV1alpha1}.\n *\n * @public\n */\nexport const componentEntityV1alpha1Validator =\n  ajvCompiledJsonSchemaValidator(schema);\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Entity } from '../entity/Entity';\nimport schema from '../schema/kinds/Domain.v1alpha1.schema.json';\nimport { ajvCompiledJsonSchemaValidator } from './util';\n\n/**\n * Backstage Domain kind Entity. Domains group Systems together.\n *\n * @remarks\n *\n * See {@link https://backstage.io/docs/features/software-catalog/system-model}\n *\n * @public\n */\nexport interface DomainEntityV1alpha1 extends Entity {\n  apiVersion: 'backstage.io/v1alpha1' | 'backstage.io/v1beta1';\n  kind: 'Domain';\n  spec: {\n    owner: string;\n  };\n}\n\n/**\n * {@link KindValidator} for {@link DomainEntityV1alpha1}.\n *\n * @public\n */\nexport const domainEntityV1alpha1Validator =\n  ajvCompiledJsonSchemaValidator(schema);\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Entity } from '../entity/Entity';\nimport schema from '../schema/kinds/Group.v1alpha1.schema.json';\nimport { ajvCompiledJsonSchemaValidator } from './util';\n\n/**\n * Backstage catalog Group kind Entity.\n *\n * @public\n */\nexport interface GroupEntityV1alpha1 extends Entity {\n  apiVersion: 'backstage.io/v1alpha1' | 'backstage.io/v1beta1';\n  kind: 'Group';\n  spec: {\n    type: string;\n    profile?: {\n      displayName?: string;\n      email?: string;\n      picture?: string;\n    };\n    parent?: string;\n    children: string[];\n    members?: string[];\n  };\n}\n\n/**\n * {@link KindValidator} for {@link GroupEntityV1alpha1}.\n * @public\n */\nexport const groupEntityV1alpha1Validator =\n  ajvCompiledJsonSchemaValidator(schema);\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Entity } from '../entity/Entity';\nimport schema from '../schema/kinds/Location.v1alpha1.schema.json';\nimport { ajvCompiledJsonSchemaValidator } from './util';\n\n/**\n * Backstage catalog Location kind Entity.\n *\n * @public\n */\nexport interface LocationEntityV1alpha1 extends Entity {\n  apiVersion: 'backstage.io/v1alpha1' | 'backstage.io/v1beta1';\n  kind: 'Location';\n  spec: {\n    type?: string;\n    target?: string;\n    targets?: string[];\n    presence?: 'required' | 'optional';\n  };\n}\n\n/**\n * {@link KindValidator} for {@link LocationEntityV1alpha1}.\n *\n * @public\n */\nexport const locationEntityV1alpha1Validator =\n  ajvCompiledJsonSchemaValidator(schema);\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/*\nNaming rules for relations in priority order:\n\n1. Use at most two words. One main verb and a specifier, e.g. \"ownerOf\"\n2. Reading out \"<source-kind> <type> <target-kind>\" should make sense in English.\n3. Maintain symmetry between pairs, e.g. \"ownedBy\" and \"ownerOf\" rather than \"owns\".\n*/\n\n/**\n * An ownership relation where the owner is usually an organizational\n * entity (user or group), and the other entity can be anything. Reversed\n * direction of {@link RELATION_OWNER_OF}.\n *\n * @public\n */\nexport const RELATION_OWNED_BY = 'ownedBy';\n\n/**\n * A relationship from an owner to the owned entity. Reversed direction of\n * {@link RELATION_OWNED_BY}.\n *\n * @public\n */\nexport const RELATION_OWNER_OF = 'ownerOf';\n\n/**\n * A relation with an API entity, typically from a component. Reversed direction of\n * {@link RELATION_API_CONSUMED_BY}.\n *\n * @public\n */\nexport const RELATION_CONSUMES_API = 'consumesApi';\n\n/**\n * A relation of an API being consumed, typically by a component. Reversed direction of\n * {@link RELATION_CONSUMES_API}.\n *\n * @public\n */\nexport const RELATION_API_CONSUMED_BY = 'apiConsumedBy';\n\n/**\n * A relation from an API provider entity (typically a component) to the API. Reversed direction of\n * {@link RELATION_API_PROVIDED_BY}.\n *\n * @public\n */\nexport const RELATION_PROVIDES_API = 'providesApi';\n\n/**\n * A relation from an API to its provider entity (typically a component). Reversed direction of\n * {@link RELATION_PROVIDES_API}.\n *\n * @public\n */\nexport const RELATION_API_PROVIDED_BY = 'apiProvidedBy';\n\n/**\n * A relation denoting a dependency on another entity. Reversed direction of\n * {@link RELATION_DEPENDENCY_OF}.\n *\n * @public\n */\nexport const RELATION_DEPENDS_ON = 'dependsOn';\n\n/**\n * A relation denoting a reverse dependency by another entity. Reversed direction of\n * {@link RELATION_DEPENDS_ON}.\n *\n * @public\n */\nexport const RELATION_DEPENDENCY_OF = 'dependencyOf';\n\n/**\n * A parent/child relation to build up a tree, used for example to describe\n * the organizational structure between groups. Reversed direction of\n * {@link RELATION_CHILD_OF}.\n *\n * @public\n */\nexport const RELATION_PARENT_OF = 'parentOf';\n\n/**\n * A relation from a child to a parent entity, used for example to describe\n * the organizational structure between groups. Reversed direction of\n * {@link RELATION_PARENT_OF}.\n *\n * @public\n */\nexport const RELATION_CHILD_OF = 'childOf';\n\n/**\n * A membership relation, typically for users in a group. Reversed direction of\n * {@link RELATION_HAS_MEMBER}.\n *\n * @public\n */\nexport const RELATION_MEMBER_OF = 'memberOf';\n\n/**\n * A relation from a group to its member, typcally a user in a group. Reversed direction of\n * {@link RELATION_MEMBER_OF}.\n *\n * @public\n */\nexport const RELATION_HAS_MEMBER = 'hasMember';\n\n/**\n * A part/whole relation, typically for components in a system and systems\n * in a domain. Reversed direction of {@link RELATION_HAS_PART}.\n *\n * @public\n */\nexport const RELATION_PART_OF = 'partOf';\n\n/**\n * A relation from a containing entity to a contained entity. Reversed direction of\n * {@link RELATION_PART_OF}.\n *\n * @public\n */\nexport const RELATION_HAS_PART = 'hasPart';\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Entity } from '../entity/Entity';\nimport schema from '../schema/kinds/Resource.v1alpha1.schema.json';\nimport { ajvCompiledJsonSchemaValidator } from './util';\n\n/**\n * Backstage catalog Resource kind Entity. Represents infrastructure required to operate Components.\n *\n * @remarks\n *\n * See {@link https://backstage.io/docs/features/software-catalog/system-model}\n *\n * @public\n */\nexport interface ResourceEntityV1alpha1 extends Entity {\n  apiVersion: 'backstage.io/v1alpha1' | 'backstage.io/v1beta1';\n  kind: 'Resource';\n  spec: {\n    type: string;\n    owner: string;\n    dependsOn?: string[];\n    dependencyOf?: string[];\n    system?: string;\n  };\n}\n\n/**\n * {@link KindValidator} for {@link ResourceEntityV1alpha1}.\n *\n * @public\n */\nexport const resourceEntityV1alpha1Validator =\n  ajvCompiledJsonSchemaValidator(schema);\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Entity } from '../entity/Entity';\nimport { ajvCompiledJsonSchemaValidator } from './util';\nimport schema from '../schema/kinds/System.v1alpha1.schema.json';\n\n/**\n * Backstage catalog System kind Entity. Systems group Components, Resources and APIs together.\n *\n * @remarks\n *\n * See {@link https://backstage.io/docs/features/software-catalog/system-model}\n *\n * @public\n */\nexport interface SystemEntityV1alpha1 extends Entity {\n  apiVersion: 'backstage.io/v1alpha1' | 'backstage.io/v1beta1';\n  kind: 'System';\n  spec: {\n    owner: string;\n    domain?: string;\n  };\n}\n\n/**\n * {@link KindValidator} for {@link SystemEntityV1alpha1}.\n *\n * @public\n */\nexport const systemEntityV1alpha1Validator =\n  ajvCompiledJsonSchemaValidator(schema);\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Entity } from '../entity/Entity';\nimport schema from '../schema/kinds/User.v1alpha1.schema.json';\nimport { ajvCompiledJsonSchemaValidator } from './util';\n\n/**\n * Backstage catalog User kind Entity.\n *\n * @public\n */\nexport interface UserEntityV1alpha1 extends Entity {\n  apiVersion: 'backstage.io/v1alpha1' | 'backstage.io/v1beta1';\n  kind: 'User';\n  spec: {\n    profile?: {\n      displayName?: string;\n      email?: string;\n      picture?: string;\n    };\n    memberOf?: string[];\n  };\n}\n\n/**\n * {@link KindValidator} for {@link UserEntityV1alpha1}.\n *\n * @public\n */\nexport const userEntityV1alpha1Validator =\n  ajvCompiledJsonSchemaValidator(schema);\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Entity annotation containing the location from which the entity is sourced.\n *\n * @public\n */\nexport const ANNOTATION_LOCATION = 'backstage.io/managed-by-location';\n\n/**\n * Entity annotation containing the originally sourced location which ultimately\n * led to this entity being ingested.\n *\n * @public\n */\nexport const ANNOTATION_ORIGIN_LOCATION =\n  'backstage.io/managed-by-origin-location';\n\n/**\n * Entity annotation pointing to the source (e.g. source code repository root or\n * similar) for this entity.\n *\n * @public\n */\nexport const ANNOTATION_SOURCE_LOCATION = 'backstage.io/source-location';\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Entity, stringifyEntityRef } from '../entity';\nimport { ANNOTATION_LOCATION, ANNOTATION_SOURCE_LOCATION } from './annotation';\n\n// See https://github.com/facebook/react/blob/f0cf832e1d0c8544c36aa8b310960885a11a847c/packages/react-dom-bindings/src/shared/sanitizeURL.js\nconst scriptProtocolPattern =\n  // eslint-disable-next-line no-control-regex\n  /^[\\u0000-\\u001F ]*j[\\r\\n\\t]*a[\\r\\n\\t]*v[\\r\\n\\t]*a[\\r\\n\\t]*s[\\r\\n\\t]*c[\\r\\n\\t]*r[\\r\\n\\t]*i[\\r\\n\\t]*p[\\r\\n\\t]*t[\\r\\n\\t]*\\:/i;\n\n/**\n * Parses a string form location reference.\n *\n * @public\n * @param ref - A string-form location ref, e.g. `'url:https://host'`\n * @returns A location ref, e.g. `{ type: 'url', target: 'https://host' }`\n */\nexport function parseLocationRef(ref: string): {\n  type: string;\n  target: string;\n} {\n  if (typeof ref !== 'string') {\n    throw new TypeError(\n      `Unable to parse location ref '${ref}', unexpected argument ${typeof ref}`,\n    );\n  }\n\n  const splitIndex = ref.indexOf(':');\n  if (splitIndex < 0) {\n    throw new TypeError(\n      `Unable to parse location ref '${ref}', expected '<type>:<target>', e.g. 'url:https://host/path'`,\n    );\n  }\n\n  const type = ref.substring(0, splitIndex).trim();\n  const target = ref.substring(splitIndex + 1).trim();\n\n  if (!type || !target) {\n    throw new TypeError(\n      `Unable to parse location ref '${ref}', expected '<type>:<target>', e.g. 'url:https://host/path'`,\n    );\n  }\n\n  if (type === 'http' || type === 'https') {\n    throw new TypeError(\n      `Invalid location ref '${ref}', please prefix it with 'url:', e.g. 'url:${ref}'`,\n    );\n  }\n\n  if (scriptProtocolPattern.test(target)) {\n    throw new TypeError(\n      `Invalid location ref '${ref}', target is a javascript: URL`,\n    );\n  }\n\n  return { type, target };\n}\n\n/**\n * Turns a location ref into its string form.\n *\n * @public\n * @param ref - A location ref, e.g. `{ type: 'url', target: 'https://host' }`\n * @returns A string-form location ref, e.g. `'url:https://host'`\n */\nexport function stringifyLocationRef(ref: {\n  type: string;\n  target: string;\n}): string {\n  const { type, target } = ref;\n\n  if (!type) {\n    throw new TypeError(`Unable to stringify location ref, empty type`);\n  } else if (!target) {\n    throw new TypeError(`Unable to stringify location ref, empty target`);\n  }\n\n  if (scriptProtocolPattern.test(target)) {\n    throw new TypeError(\n      `Invalid location ref '${type}:${target}', target is a javascript: URL`,\n    );\n  }\n\n  return `${type}:${target}`;\n}\n\n/**\n * Returns the source code location of the Entity, to the extent that one exists.\n *\n * @remarks\n *\n * If the returned location type is of type 'url', the target should be readable at least\n * using the UrlReader from `@backstage/backend-common`. If it is not of type 'url', the caller\n * needs to have explicit handling of each location type or signal that it is not supported.\n *\n * @public\n */\nexport function getEntitySourceLocation(entity: Entity): {\n  type: string;\n  target: string;\n} {\n  const locationRef =\n    entity.metadata?.annotations?.[ANNOTATION_SOURCE_LOCATION] ??\n    entity.metadata?.annotations?.[ANNOTATION_LOCATION];\n\n  if (!locationRef) {\n    throw new Error(\n      `Entity '${stringifyEntityRef(entity)}' is missing location`,\n    );\n  }\n\n  return parseLocationRef(locationRef);\n}\n"],"names":["__publicField","require","schema"],"mappings":"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"}