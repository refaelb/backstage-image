{"version":3,"file":"Router-5d4d36fb.esm.js","sources":["../../src/legacy/TemplateCard/TemplateCard.tsx","../../src/legacy/TemplateList/TemplateList.tsx","../../src/legacy/ScaffolderPage/ScaffolderPageContextMenu.tsx","../../src/legacy/ScaffolderPage/ScaffolderPage.tsx","../../src/legacy/MultistepJsonForm/schema.ts","../../src/legacy/MultistepJsonForm/FieldOverrides/DescriptionField.tsx","../../src/legacy/MultistepJsonForm/ReviewStep.tsx","../../src/legacy/MultistepJsonForm/MultistepJsonForm.tsx","../../src/legacy/TemplatePage/createValidator.ts","../../src/legacy/TemplatePage/TemplatePage.tsx","../../src/legacy/TemplateEditorPage/TemplateEditorForm.tsx","../../src/legacy/TemplateEditorPage/TemplateEditor.tsx","../../src/legacy/TemplateEditorPage/TemplateFormPreviewer.tsx","../../src/legacy/TemplateEditorPage/CustomFieldExplorer.tsx","../../src/legacy/TemplateEditorPage/TemplateEditorPage.tsx","../../src/legacy/Router.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  DEFAULT_NAMESPACE,\n  Entity,\n  EntityLink,\n  parseEntityRef,\n  RELATION_OWNED_BY,\n  stringifyEntityRef,\n} from '@backstage/catalog-model';\nimport {\n  ItemCardHeader,\n  Link,\n  LinkButton,\n  MarkdownContent,\n} from '@backstage/core-components';\nimport {\n  IconComponent,\n  useApi,\n  useApp,\n  useRouteRef,\n} from '@backstage/core-plugin-api';\nimport {\n  ScmIntegrationIcon,\n  scmIntegrationsApiRef,\n} from '@backstage/integration-react';\nimport {\n  EntityRefLinks,\n  FavoriteEntity,\n  getEntityRelations,\n  getEntitySourceLocation,\n} from '@backstage/plugin-catalog-react';\nimport { TemplateEntityV1beta3 } from '@backstage/plugin-scaffolder-common';\nimport {\n  Box,\n  Card,\n  CardActions,\n  CardContent,\n  CardMedia,\n  Chip,\n  IconButton,\n  makeStyles,\n  Theme,\n  Tooltip,\n  Typography,\n  useTheme,\n} from '@material-ui/core';\nimport LanguageIcon from '@material-ui/icons/Language';\nimport WarningIcon from '@material-ui/icons/Warning';\nimport React from 'react';\nimport { selectedTemplateRouteRef, viewTechDocRouteRef } from '../../routes';\n\nconst useStyles = makeStyles<\n  Theme,\n  { fontColor: string; backgroundImage: string }\n>(theme => ({\n  cardHeader: {\n    position: 'relative',\n  },\n  title: {\n    backgroundImage: ({ backgroundImage }) => backgroundImage,\n    color: ({ fontColor }) => fontColor,\n  },\n  box: {\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    display: '-webkit-box',\n    '-webkit-line-clamp': 10,\n    '-webkit-box-orient': 'vertical',\n  },\n  label: {\n    color: theme.palette.text.secondary,\n    textTransform: 'uppercase',\n    fontSize: '0.65rem',\n    fontWeight: 'bold',\n    letterSpacing: 0.5,\n    lineHeight: 1,\n    paddingBottom: '0.2rem',\n  },\n  linksLabel: {\n    padding: '0 16px',\n  },\n  description: {\n    '& p': {\n      margin: '0px',\n    },\n  },\n  leftButton: {\n    marginRight: 'auto',\n  },\n  starButton: {\n    position: 'absolute',\n    top: theme.spacing(0.5),\n    right: theme.spacing(0.5),\n    padding: '0.25rem',\n    color: ({ fontColor }) => fontColor,\n  },\n}));\n\nconst MuiIcon = ({ icon: Icon }: { icon: IconComponent }) => <Icon />;\n\nconst useDeprecationStyles = makeStyles(theme => ({\n  deprecationIcon: {\n    position: 'absolute',\n    top: theme.spacing(0.5),\n    right: theme.spacing(3.5),\n    padding: '0.25rem',\n  },\n  link: {\n    color: theme.palette.warning.light,\n  },\n}));\n\nexport type TemplateCardProps = {\n  template: TemplateEntityV1beta3;\n  deprecated?: boolean;\n};\n\ntype TemplateProps = {\n  description: string;\n  tags: string[];\n  title: string;\n  type: string;\n  name: string;\n  links: EntityLink[];\n};\n\nconst getTemplateCardProps = (\n  template: TemplateEntityV1beta3,\n): TemplateProps & { key: string } => {\n  return {\n    key: template.metadata.uid!,\n    name: template.metadata.name,\n    title: `${(template.metadata.title || template.metadata.name) ?? ''}`,\n    type: template.spec.type ?? '',\n    description: template.metadata.description ?? '-',\n    tags: (template.metadata?.tags as string[]) ?? [],\n    links: template.metadata.links ?? [],\n  };\n};\n\nconst DeprecationWarning = () => {\n  const styles = useDeprecationStyles();\n\n  const Title = (\n    <Typography style={{ padding: 10, maxWidth: 300 }}>\n      This template uses a syntax that has been deprecated, and should be\n      migrated to a newer syntax. Click for more info.\n    </Typography>\n  );\n\n  return (\n    <div className={styles.deprecationIcon}>\n      <Tooltip title={Title}>\n        <Link\n          to=\"https://backstage.io/docs/features/software-templates/migrating-from-v1beta2-to-v1beta3\"\n          className={styles.link}\n        >\n          <WarningIcon />\n        </Link>\n      </Tooltip>\n    </div>\n  );\n};\n\nexport const TemplateCard = ({ template, deprecated }: TemplateCardProps) => {\n  const app = useApp();\n  const backstageTheme = useTheme();\n  const templateRoute = useRouteRef(selectedTemplateRouteRef);\n  const templateProps = getTemplateCardProps(template);\n  const ownedByRelations = getEntityRelations(\n    template as Entity,\n    RELATION_OWNED_BY,\n  );\n  const themeId = backstageTheme.getPageTheme({ themeId: templateProps.type })\n    ? templateProps.type\n    : 'other';\n  const theme = backstageTheme.getPageTheme({ themeId });\n  const classes = useStyles({\n    fontColor: theme.fontColor,\n    backgroundImage: theme.backgroundImage,\n  });\n  const { name, namespace } = parseEntityRef(stringifyEntityRef(template));\n  const href = templateRoute({ templateName: name, namespace });\n\n  // TechDocs Link\n  const viewTechDoc = useRouteRef(viewTechDocRouteRef);\n  const viewTechDocsAnnotation =\n    template.metadata.annotations?.['backstage.io/techdocs-ref'];\n  const viewTechDocsLink =\n    !!viewTechDocsAnnotation &&\n    !!viewTechDoc &&\n    viewTechDoc({\n      namespace: template.metadata.namespace || DEFAULT_NAMESPACE,\n      kind: template.kind,\n      name: template.metadata.name,\n    });\n\n  const iconResolver = (key?: string): IconComponent =>\n    key ? app.getSystemIcon(key) ?? LanguageIcon : LanguageIcon;\n\n  const scmIntegrationsApi = useApi(scmIntegrationsApiRef);\n  const sourceLocation = getEntitySourceLocation(template, scmIntegrationsApi);\n\n  return (\n    <Card>\n      <CardMedia className={classes.cardHeader}>\n        <FavoriteEntity className={classes.starButton} entity={template} />\n        {deprecated && <DeprecationWarning />}\n        <ItemCardHeader\n          title={templateProps.title}\n          subtitle={templateProps.type}\n          classes={{ root: classes.title }}\n        />\n      </CardMedia>\n      <CardContent\n        style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}\n      >\n        <Box className={classes.box}>\n          <Typography variant=\"body2\" className={classes.label}>\n            Description\n          </Typography>\n          <MarkdownContent\n            className={classes.description}\n            content={templateProps.description}\n          />\n        </Box>\n        <Box className={classes.box}>\n          <Typography variant=\"body2\" className={classes.label}>\n            Owner\n          </Typography>\n          <EntityRefLinks\n            entityRefs={ownedByRelations}\n            defaultKind=\"Group\"\n            hideIcons\n          />\n        </Box>\n        <Box>\n          <Typography\n            style={{ marginBottom: '4px' }}\n            variant=\"body2\"\n            className={classes.label}\n          >\n            Tags\n          </Typography>\n          {templateProps.tags?.map(tag => (\n            <Chip size=\"small\" label={tag} key={tag} />\n          ))}\n        </Box>\n      </CardContent>\n      <Typography\n        variant=\"body2\"\n        className={[classes.label, classes.linksLabel].join(' ')}\n      >\n        Links\n      </Typography>\n      <CardActions>\n        <div className={classes.leftButton}>\n          {sourceLocation && (\n            <Tooltip\n              title={\n                sourceLocation.integrationType ||\n                sourceLocation.locationTargetUrl\n              }\n            >\n              <IconButton\n                className={classes.leftButton}\n                href={sourceLocation.locationTargetUrl}\n              >\n                <ScmIntegrationIcon type={sourceLocation.integrationType} />\n              </IconButton>\n            </Tooltip>\n          )}\n          {viewTechDocsLink && (\n            <Tooltip title=\"View TechDocs\">\n              <IconButton\n                className={classes.leftButton}\n                href={viewTechDocsLink}\n              >\n                <MuiIcon icon={iconResolver('docs')} />\n              </IconButton>\n            </Tooltip>\n          )}\n          {templateProps.links?.map((link, i) => (\n            <Tooltip key={`${link.url}_${i}`} title={link.title || link.url}>\n              <IconButton size=\"medium\" href={link.url}>\n                <MuiIcon icon={iconResolver(link.icon)} />\n              </IconButton>\n            </Tooltip>\n          ))}\n        </div>\n        <LinkButton\n          color=\"primary\"\n          to={href}\n          aria-label={`Choose ${templateProps.title}`}\n        >\n          Choose\n        </LinkButton>\n      </CardActions>\n    </Card>\n  );\n};\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { ComponentType } from 'react';\nimport { Entity, stringifyEntityRef } from '@backstage/catalog-model';\nimport {\n  isTemplateEntityV1beta3,\n  TemplateEntityV1beta3,\n} from '@backstage/plugin-scaffolder-common';\nimport {\n  Content,\n  ContentHeader,\n  ItemCardGrid,\n  Link,\n  Progress,\n  WarningPanel,\n} from '@backstage/core-components';\nimport { useEntityList } from '@backstage/plugin-catalog-react';\nimport { Typography } from '@material-ui/core';\nimport { TemplateCard } from '../TemplateCard';\n\n/**\n * @internal\n */\nexport type TemplateListProps = {\n  TemplateCardComponent?:\n    | ComponentType<{ template: TemplateEntityV1beta3 }>\n    | undefined;\n  group?: {\n    title?: React.ReactNode;\n    filter: (entity: TemplateEntityV1beta3) => boolean;\n  };\n  templateFilter?: (entity: TemplateEntityV1beta3) => boolean;\n};\n\n/**\n * @internal\n */\nexport const TemplateList = ({\n  TemplateCardComponent,\n  group,\n  templateFilter,\n}: TemplateListProps) => {\n  const { loading, error, entities } = useEntityList();\n  const Card = TemplateCardComponent || TemplateCard;\n  const templateEntities = entities.filter(isTemplateEntityV1beta3);\n  const maybeFilteredEntities = (\n    group ? templateEntities.filter(group.filter) : templateEntities\n  ).filter(e => (templateFilter ? templateFilter(e) : true));\n\n  const titleComponent: React.ReactNode = (() => {\n    if (group && group.title) {\n      if (typeof group.title === 'string') {\n        return <ContentHeader title={group.title} />;\n      }\n      return group.title;\n    }\n\n    return <ContentHeader title=\"Other Templates\" />;\n  })();\n\n  if (group && maybeFilteredEntities.length === 0) {\n    return null;\n  }\n  return (\n    <>\n      {loading && <Progress />}\n\n      {error && (\n        <WarningPanel title=\"Oops! Something went wrong loading the templates\">\n          {error.message}\n        </WarningPanel>\n      )}\n\n      {!error && !loading && !entities.length && (\n        <Typography variant=\"body2\">\n          No templates found that match your filter. Learn more about{' '}\n          <Link to=\"https://backstage.io/docs/features/software-templates/adding-templates\">\n            adding templates\n          </Link>\n          .\n        </Typography>\n      )}\n\n      <Content>\n        {titleComponent}\n        <ItemCardGrid>\n          {maybeFilteredEntities &&\n            maybeFilteredEntities?.length > 0 &&\n            maybeFilteredEntities.map((template: Entity) => (\n              <Card\n                key={stringifyEntityRef(template)}\n                template={template as TemplateEntityV1beta3}\n                deprecated={template.apiVersion === 'backstage.io/v1beta2'}\n              />\n            ))}\n        </ItemCardGrid>\n      </Content>\n    </>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useRouteRef } from '@backstage/core-plugin-api';\nimport IconButton from '@material-ui/core/IconButton';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport MenuList from '@material-ui/core/MenuList';\nimport Popover from '@material-ui/core/Popover';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Description from '@material-ui/icons/Description';\nimport Edit from '@material-ui/icons/Edit';\nimport List from '@material-ui/icons/List';\nimport MoreVert from '@material-ui/icons/MoreVert';\nimport React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport {\n  actionsRouteRef,\n  editRouteRef,\n  scaffolderListTaskRouteRef,\n} from '../../routes';\n\nconst useStyles = makeStyles(theme => ({\n  button: {\n    color: theme.page.fontColor,\n  },\n}));\n\nexport type ScaffolderPageContextMenuProps = {\n  editor?: boolean;\n  actions?: boolean;\n  tasks?: boolean;\n};\n\nexport function ScaffolderPageContextMenu(\n  props: ScaffolderPageContextMenuProps,\n) {\n  const classes = useStyles();\n  const [anchorEl, setAnchorEl] = useState<HTMLButtonElement>();\n  const editLink = useRouteRef(editRouteRef);\n  const actionsLink = useRouteRef(actionsRouteRef);\n  const tasksLink = useRouteRef(scaffolderListTaskRouteRef);\n\n  const navigate = useNavigate();\n\n  const showEditor = props.editor !== false;\n  const showActions = props.actions !== false;\n  const showTasks = props.tasks !== false;\n\n  if (!showEditor && !showActions) {\n    return null;\n  }\n\n  const onOpen = (event: React.SyntheticEvent<HTMLButtonElement>) => {\n    setAnchorEl(event.currentTarget);\n  };\n\n  const onClose = () => {\n    setAnchorEl(undefined);\n  };\n\n  return (\n    <>\n      <IconButton\n        id=\"long-menu\"\n        aria-label=\"more\"\n        aria-controls=\"long-menu\"\n        aria-expanded={!!anchorEl}\n        aria-haspopup=\"true\"\n        role=\"button\"\n        onClick={onOpen}\n        data-testid=\"menu-button\"\n        color=\"inherit\"\n        className={classes.button}\n      >\n        <MoreVert />\n      </IconButton>\n      <Popover\n        aria-labelledby=\"long-menu\"\n        open={Boolean(anchorEl)}\n        onClose={onClose}\n        anchorEl={anchorEl}\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'right' }}\n        transformOrigin={{ vertical: 'top', horizontal: 'right' }}\n      >\n        <MenuList>\n          {showEditor && (\n            <MenuItem onClick={() => navigate(editLink())}>\n              <ListItemIcon>\n                <Edit fontSize=\"small\" />\n              </ListItemIcon>\n              <ListItemText primary=\"Template Editor\" />\n            </MenuItem>\n          )}\n          {showActions && (\n            <MenuItem onClick={() => navigate(actionsLink())}>\n              <ListItemIcon>\n                <Description fontSize=\"small\" />\n              </ListItemIcon>\n              <ListItemText primary=\"Installed Actions\" />\n            </MenuItem>\n          )}\n          {showTasks && (\n            <MenuItem onClick={() => navigate(tasksLink())}>\n              <ListItemIcon>\n                <List fontSize=\"small\" />\n              </ListItemIcon>\n              <ListItemText primary=\"Task List\" />\n            </MenuItem>\n          )}\n        </MenuList>\n      </Popover>\n    </>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Content,\n  ContentHeader,\n  CreateButton,\n  Header,\n  Page,\n  SupportButton,\n} from '@backstage/core-components';\nimport { TemplateEntityV1beta3 } from '@backstage/plugin-scaffolder-common';\nimport { useRouteRef } from '@backstage/core-plugin-api';\nimport {\n  CatalogFilterLayout,\n  EntityKindPicker,\n  EntityListProvider,\n  EntitySearchBar,\n  EntityTagPicker,\n  UserListPicker,\n} from '@backstage/plugin-catalog-react';\nimport React, { ComponentType } from 'react';\nimport { TemplateList } from '../TemplateList';\nimport { catalogEntityCreatePermission } from '@backstage/plugin-catalog-common/alpha';\nimport { usePermission } from '@backstage/plugin-permission-react';\nimport { ScaffolderPageContextMenu } from './ScaffolderPageContextMenu';\nimport { registerComponentRouteRef } from '../../routes';\nimport { TemplateTypePicker } from '../../components';\n\nexport type ScaffolderPageProps = {\n  TemplateCardComponent?:\n    | ComponentType<{ template: TemplateEntityV1beta3 }>\n    | undefined;\n  groups?: Array<{\n    title?: React.ReactNode;\n    filter: (entity: TemplateEntityV1beta3) => boolean;\n  }>;\n  templateFilter?: (entity: TemplateEntityV1beta3) => boolean;\n  contextMenu?: {\n    editor?: boolean;\n    actions?: boolean;\n    tasks?: boolean;\n  };\n  headerOptions?: {\n    pageTitleOverride?: string;\n    title?: string;\n    subtitle?: string;\n  };\n};\n\nexport const ScaffolderPageContents = ({\n  TemplateCardComponent,\n  groups,\n  templateFilter,\n  contextMenu,\n  headerOptions,\n}: ScaffolderPageProps) => {\n  const registerComponentLink = useRouteRef(registerComponentRouteRef);\n  const otherTemplatesGroup = {\n    title: groups ? 'Other Templates' : 'Templates',\n    filter: (entity: TemplateEntityV1beta3) => {\n      const filtered = (groups ?? []).map(group => group.filter(entity));\n      return !filtered.some(result => result === true);\n    },\n  };\n\n  const { allowed } = usePermission({\n    permission: catalogEntityCreatePermission,\n  });\n\n  return (\n    <Page themeId=\"home\">\n      <Header\n        pageTitleOverride=\"Create a New Component\"\n        title=\"Create a New Component\"\n        subtitle=\"Create new software components using standard templates\"\n        {...headerOptions}\n      >\n        <ScaffolderPageContextMenu {...contextMenu} />\n      </Header>\n      <Content>\n        <ContentHeader title=\"Available Templates\">\n          {allowed && (\n            <CreateButton\n              title=\"Register Existing Component\"\n              to={registerComponentLink && registerComponentLink()}\n            />\n          )}\n          <SupportButton>\n            Create new software components using standard templates. Different\n            templates create different kinds of components (services, websites,\n            documentation, ...).\n          </SupportButton>\n        </ContentHeader>\n\n        <CatalogFilterLayout>\n          <CatalogFilterLayout.Filters>\n            <EntitySearchBar />\n            <EntityKindPicker initialFilter=\"template\" hidden />\n            <UserListPicker\n              initialFilter=\"all\"\n              availableFilters={['all', 'starred']}\n            />\n            <TemplateTypePicker />\n            <EntityTagPicker />\n          </CatalogFilterLayout.Filters>\n          <CatalogFilterLayout.Content>\n            {groups &&\n              groups.map((group, index) => (\n                <TemplateList\n                  key={index}\n                  TemplateCardComponent={TemplateCardComponent}\n                  group={group}\n                  templateFilter={templateFilter}\n                />\n              ))}\n            <TemplateList\n              key=\"other\"\n              TemplateCardComponent={TemplateCardComponent}\n              templateFilter={templateFilter}\n              group={otherTemplatesGroup}\n            />\n          </CatalogFilterLayout.Content>\n        </CatalogFilterLayout>\n      </Content>\n    </Page>\n  );\n};\n\nexport const ScaffolderPage = ({\n  TemplateCardComponent,\n  groups,\n  templateFilter,\n  contextMenu,\n  headerOptions,\n}: ScaffolderPageProps) => (\n  <EntityListProvider>\n    <ScaffolderPageContents\n      TemplateCardComponent={TemplateCardComponent}\n      groups={groups}\n      templateFilter={templateFilter}\n      contextMenu={contextMenu}\n      headerOptions={headerOptions}\n    />\n  </EntityListProvider>\n);\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { JsonObject } from '@backstage/types';\nimport { UiSchema } from '@rjsf/utils';\nimport type { LayoutOptions } from '@backstage/plugin-scaffolder-react';\nimport { FormProps } from '@rjsf/core';\n\nfunction isObject(value: unknown): value is JsonObject {\n  return typeof value === 'object' && value !== null && !Array.isArray(value);\n}\n\nfunction extractUiSchema(schema: JsonObject, uiSchema: JsonObject) {\n  if (!isObject(schema)) {\n    return;\n  }\n\n  const { properties, items, anyOf, oneOf, allOf, dependencies } = schema;\n\n  for (const propName in schema) {\n    if (!schema.hasOwnProperty(propName)) {\n      continue;\n    }\n\n    if (propName.startsWith('ui:')) {\n      uiSchema[propName] = schema[propName];\n      delete schema[propName];\n    }\n  }\n\n  if (isObject(properties)) {\n    for (const propName in properties) {\n      if (!properties.hasOwnProperty(propName)) {\n        continue;\n      }\n\n      const schemaNode = properties[propName];\n      if (!isObject(schemaNode)) {\n        continue;\n      }\n      const innerUiSchema = {};\n      uiSchema[propName] = uiSchema[propName] || innerUiSchema;\n      extractUiSchema(schemaNode, innerUiSchema);\n    }\n  }\n\n  if (isObject(items)) {\n    const innerUiSchema = {};\n    uiSchema.items = innerUiSchema;\n    extractUiSchema(items, innerUiSchema);\n  }\n\n  if (Array.isArray(anyOf)) {\n    for (const schemaNode of anyOf) {\n      if (!isObject(schemaNode)) {\n        continue;\n      }\n      extractUiSchema(schemaNode, uiSchema);\n    }\n  }\n\n  if (Array.isArray(oneOf)) {\n    for (const schemaNode of oneOf) {\n      if (!isObject(schemaNode)) {\n        continue;\n      }\n      extractUiSchema(schemaNode, uiSchema);\n    }\n  }\n\n  if (Array.isArray(allOf)) {\n    for (const schemaNode of allOf) {\n      if (!isObject(schemaNode)) {\n        continue;\n      }\n      extractUiSchema(schemaNode, uiSchema);\n    }\n  }\n\n  if (isObject(dependencies)) {\n    for (const depName of Object.keys(dependencies)) {\n      const schemaNode = dependencies[depName];\n      if (!isObject(schemaNode)) {\n        continue;\n      }\n      extractUiSchema(schemaNode, uiSchema);\n    }\n  }\n}\n\nexport function transformSchemaToProps(\n  inputSchema: JsonObject,\n  layouts: LayoutOptions[] = [],\n): {\n  schema: FormProps<any>['schema'];\n  uiSchema: FormProps<any>['uiSchema'];\n} {\n  const customLayoutName = inputSchema['ui:ObjectFieldTemplate'];\n  inputSchema.type = inputSchema.type || 'object';\n  const schema = JSON.parse(JSON.stringify(inputSchema));\n  delete schema.title; // Rendered separately\n  const uiSchema: UiSchema = {};\n  extractUiSchema(schema, uiSchema);\n\n  if (customLayoutName) {\n    const Layout = layouts.find(\n      layout => layout.name === customLayoutName,\n    )?.component;\n\n    if (Layout) {\n      uiSchema['ui:ObjectFieldTemplate'] = Layout;\n    }\n  }\n\n  return { schema, uiSchema };\n}\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { MarkdownContent } from '@backstage/core-components';\nimport { FieldProps } from '@rjsf/utils';\n\nexport const DescriptionField = ({ description }: FieldProps) =>\n  description && <MarkdownContent content={description} linkTarget=\"_blank\" />;\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Box, Button, Paper, Typography } from '@material-ui/core';\nimport React from 'react';\nimport { Content, StructuredMetadataTable } from '@backstage/core-components';\nimport { UiSchema } from '@rjsf/utils';\nimport { JsonObject } from '@backstage/types';\nimport { ReviewStepProps } from '@backstage/plugin-scaffolder-react';\n\nexport function getReviewData(\n  formData: Record<string, any>,\n  uiSchemas: UiSchema[],\n) {\n  const reviewData: Record<string, any> = {};\n  const orderedReviewProperties = new Set(\n    uiSchemas.map(us => us.name).concat(Object.getOwnPropertyNames(formData)),\n  );\n\n  for (const key of orderedReviewProperties) {\n    const uiSchema = uiSchemas.find(us => us.name === key);\n\n    if (!uiSchema) {\n      reviewData[key] = formData[key];\n      continue;\n    }\n\n    if (uiSchema['ui:widget'] === 'password') {\n      reviewData[key] = '******';\n      continue;\n    }\n\n    if (!uiSchema['ui:backstage'] || !uiSchema['ui:backstage'].review) {\n      reviewData[key] = formData[key];\n      continue;\n    }\n\n    const review = uiSchema['ui:backstage'].review as JsonObject;\n    if (review.mask) {\n      reviewData[key] = review.mask;\n      continue;\n    }\n\n    if (!review.show) {\n      continue;\n    }\n    reviewData[key] = formData[key];\n  }\n\n  return reviewData;\n}\n\nexport function getUiSchemasFromSteps(\n  steps: {\n    schema: JsonObject;\n  }[],\n): UiSchema[] {\n  const uiSchemas: Array<UiSchema> = [];\n  steps.forEach(step => {\n    const schemaProps = step.schema.properties as JsonObject;\n    for (const key in schemaProps) {\n      if (schemaProps.hasOwnProperty(key)) {\n        const uiSchema = schemaProps[key] as UiSchema;\n        uiSchema.name = key;\n        uiSchemas.push(uiSchema);\n      }\n    }\n  });\n  return uiSchemas;\n}\n\n/**\n * The component displaying the Last Step in scaffolder template form.\n * Which represents the summary of the input provided by the end user.\n */\nexport const ReviewStep = (props: ReviewStepProps) => {\n  const {\n    disableButtons,\n    formData,\n    handleBack,\n    handleCreate,\n    handleReset,\n    steps,\n  } = props;\n  return (\n    <Content>\n      <Paper square elevation={0}>\n        <Typography variant=\"h6\">Review and create</Typography>\n        <StructuredMetadataTable\n          dense\n          metadata={getReviewData(\n            formData,\n            getUiSchemasFromSteps(\n              steps.map(({ mergedSchema }) => ({ schema: mergedSchema })),\n            ),\n          )}\n        />\n        <Box mb={4} />\n        <Button onClick={handleBack} disabled={disableButtons}>\n          Back\n        </Button>\n        <Button onClick={handleReset} disabled={disableButtons}>\n          Reset\n        </Button>\n        <Button\n          variant=\"contained\"\n          color=\"primary\"\n          onClick={handleCreate}\n          disabled={disableButtons}\n        >\n          Create\n        </Button>\n      </Paper>\n    </Content>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {\n  Button,\n  Step as StepUI,\n  StepContent,\n  StepLabel,\n  Stepper,\n  Typography,\n} from '@material-ui/core';\nimport { JsonObject } from '@backstage/types';\nimport {\n  errorApiRef,\n  featureFlagsApiRef,\n  useAnalytics,\n  useRouteRefParams,\n  useApi,\n} from '@backstage/core-plugin-api';\nimport { FormProps, IChangeEvent, withTheme } from '@rjsf/core';\nimport { Theme as MuiTheme } from '@rjsf/material-ui';\nimport React, { ComponentType, useState } from 'react';\nimport { transformSchemaToProps } from './schema';\nimport cloneDeep from 'lodash/cloneDeep';\nimport * as fieldOverrides from './FieldOverrides';\nimport { ReviewStep } from './ReviewStep';\nimport validator from '@rjsf/validator-ajv8';\nimport { extractSchemaFromStep } from '@backstage/plugin-scaffolder-react/alpha';\nimport { selectedTemplateRouteRef } from '../../routes';\nimport {\n  LayoutOptions,\n  ReviewStepProps,\n} from '@backstage/plugin-scaffolder-react';\n\nconst Form = withTheme(MuiTheme);\n\ntype Step = {\n  schema: JsonObject;\n  title: string;\n} & Partial<Omit<FormProps<any>, 'schema'>>;\n\n/**\n * The props for a dynamic form of a scaffolder template.\n */\nexport type MultistepJsonFormProps = {\n  /**\n   * Steps for the form, each contains title and form schema\n   */\n  steps: Step[];\n  formData: Record<string, any>;\n  onChange: (e: IChangeEvent) => void;\n  onReset: () => void;\n  onFinish?: () => Promise<void>;\n  widgets?: FormProps<any>['widgets'];\n  fields?: FormProps<any>['fields'];\n  finishButtonLabel?: string;\n  layouts: LayoutOptions[];\n  ReviewStepComponent?: ComponentType<ReviewStepProps>;\n};\n\nexport function getSchemasFromSteps(steps: Step[]) {\n  return steps.map(({ schema }) => ({\n    mergedSchema: schema,\n    ...extractSchemaFromStep(schema),\n  }));\n}\n\n/**\n * Creates the dynamic form for a scaffolder template.\n */\nexport const MultistepJsonForm = (props: MultistepJsonFormProps) => {\n  const {\n    formData,\n    onChange,\n    onReset,\n    onFinish,\n    fields,\n    widgets,\n    layouts,\n    ReviewStepComponent,\n  } = props;\n  const { templateName } = useRouteRefParams(selectedTemplateRouteRef);\n  const analytics = useAnalytics();\n  const [activeStep, setActiveStep] = useState(0);\n  const [disableButtons, setDisableButtons] = useState(false);\n  const errorApi = useApi(errorApiRef);\n  const featureFlagApi = useApi(featureFlagsApiRef);\n  const featureFlagKey = 'backstage:featureFlag';\n  const filterOutProperties = (step: Step): Step => {\n    const filteredStep = cloneDeep(step);\n    const removedPropertyKeys: Array<string> = [];\n    if (filteredStep.schema.properties) {\n      filteredStep.schema.properties = Object.fromEntries(\n        Object.entries(filteredStep.schema.properties).filter(\n          ([key, value]) => {\n            if (value[featureFlagKey]) {\n              if (featureFlagApi.isActive(value[featureFlagKey])) {\n                return true;\n              }\n              removedPropertyKeys.push(key);\n              return false;\n            }\n            return true;\n          },\n        ),\n      );\n\n      // remove the feature flag property key from required if they are not active\n      filteredStep.schema.required = Array.isArray(filteredStep.schema.required)\n        ? filteredStep.schema.required?.filter(\n            r => !removedPropertyKeys.includes(r as string),\n          )\n        : filteredStep.schema.required;\n    }\n    return filteredStep;\n  };\n\n  const steps = props.steps\n    .filter(step => {\n      const featureFlag = step.schema[featureFlagKey];\n      return (\n        typeof featureFlag !== 'string' || featureFlagApi.isActive(featureFlag)\n      );\n    })\n    .map(filterOutProperties);\n\n  const handleReset = () => {\n    setActiveStep(0);\n    onReset();\n  };\n  const handleNext = () => {\n    const stepNum = Math.min(activeStep + 1, steps.length);\n    setActiveStep(stepNum);\n    analytics.captureEvent('click', `Next Step (${stepNum})`);\n  };\n  const handleBack = () => setActiveStep(Math.max(activeStep - 1, 0));\n  const handleCreate = async () => {\n    if (!onFinish) {\n      return;\n    }\n\n    setDisableButtons(true);\n    try {\n      await onFinish();\n      analytics.captureEvent('create', formData.name || `new ${templateName}`);\n    } catch (err) {\n      errorApi.post(err);\n    } finally {\n      setDisableButtons(false);\n    }\n  };\n\n  const ReviewStepElement = ReviewStepComponent ?? ReviewStep;\n\n  return (\n    <>\n      <Stepper activeStep={activeStep} orientation=\"vertical\">\n        {steps.map(({ title, schema, ...formProps }, index) => {\n          return (\n            <StepUI key={title}>\n              <StepLabel\n                aria-label={`Step ${index + 1} ${title}`}\n                aria-disabled=\"false\"\n                tabIndex={0}\n              >\n                <Typography variant=\"h6\" component=\"h2\">\n                  {title}\n                </Typography>\n              </StepLabel>\n              <StepContent key={title}>\n                <Form\n                  validator={validator}\n                  showErrorList={false}\n                  fields={{ ...fieldOverrides, ...fields }}\n                  widgets={widgets}\n                  noHtml5Validate\n                  formData={formData}\n                  formContext={{ formData }}\n                  onChange={onChange}\n                  onSubmit={(e: IChangeEvent<any>) => {\n                    if (e.errors.length === 0) handleNext();\n                  }}\n                  experimental_defaultFormStateBehavior={{\n                    allOf: 'populateDefaults',\n                  }}\n                  {...formProps}\n                  {...transformSchemaToProps(schema, layouts)}\n                >\n                  <Button disabled={activeStep === 0} onClick={handleBack}>\n                    Back\n                  </Button>\n                  <Button variant=\"contained\" color=\"primary\" type=\"submit\">\n                    Next step\n                  </Button>\n                </Form>\n              </StepContent>\n            </StepUI>\n          );\n        })}\n      </Stepper>\n      {activeStep === steps.length && (\n        <ReviewStepElement\n          disableButtons={disableButtons}\n          handleBack={handleBack}\n          handleCreate={handleCreate}\n          handleReset={handleReset}\n          formData={formData}\n          steps={getSchemasFromSteps(steps)}\n        />\n      )}\n    </>\n  );\n};\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { LegacyCustomFieldValidator } from '@backstage/plugin-scaffolder-react/alpha';\nimport { FieldValidation, FormValidation } from '@rjsf/utils';\nimport { JsonObject, JsonValue } from '@backstage/types';\nimport { ApiHolder } from '@backstage/core-plugin-api';\n\nfunction isObject(obj: unknown): obj is JsonObject {\n  return typeof obj === 'object' && obj !== null && !Array.isArray(obj);\n}\n\nfunction isArray(obj: unknown): obj is JsonObject {\n  return typeof obj === 'object' && obj !== null && Array.isArray(obj);\n}\n\nexport const createValidator = (\n  rootSchema: JsonObject,\n  validators: Record<string, undefined | LegacyCustomFieldValidator<unknown>>,\n  context: {\n    apiHolder: ApiHolder;\n  },\n) => {\n  function validate(\n    schema: JsonObject,\n    formData: JsonObject,\n    errors: FormValidation,\n  ) {\n    const schemaProps = schema.properties;\n    const customObject = schema.type === 'object' && schemaProps === undefined;\n\n    if (!isObject(schemaProps) && !customObject) {\n      return;\n    }\n\n    if (schemaProps) {\n      for (const [key, propData] of Object.entries(formData)) {\n        const propValidation = errors[key];\n\n        const doValidate = (item: JsonValue | undefined) => {\n          if (item && isObject(item)) {\n            const fieldName = item['ui:field'] as string;\n            if (fieldName && typeof validators[fieldName] === 'function') {\n              validators[fieldName]!(\n                propData as JsonObject[],\n                propValidation as FieldValidation,\n                context,\n              );\n            }\n          }\n        };\n\n        const propSchemaProps = schemaProps[key];\n        if (isObject(propData) && isObject(propSchemaProps)) {\n          validate(\n            propSchemaProps,\n            propData as JsonObject,\n            propValidation as FormValidation,\n          );\n        } else if (isArray(propData)) {\n          if (isObject(propSchemaProps)) {\n            const { items } = propSchemaProps;\n            if (isObject(items)) {\n              if (items.type === 'object') {\n                const properties = (items?.properties ?? []) as JsonObject[];\n                for (const [, value] of Object.entries(properties)) {\n                  doValidate(value);\n                }\n              } else {\n                doValidate(items);\n              }\n            }\n          }\n        } else {\n          doValidate(propSchemaProps);\n        }\n      }\n    } else if (customObject) {\n      const fieldName = schema['ui:field'] as string;\n      if (fieldName && typeof validators[fieldName] === 'function') {\n        validators[fieldName]!(formData, errors, context);\n      }\n    }\n  }\n\n  return (formData: JsonObject, errors: FormValidation) => {\n    validate(rootSchema, formData, errors);\n    return errors;\n  };\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { LinearProgress } from '@material-ui/core';\nimport { IChangeEvent } from '@rjsf/core';\nimport qs from 'qs';\nimport React, { ComponentType, useCallback, useState } from 'react';\nimport { Navigate, useNavigate } from 'react-router-dom';\nimport useAsync from 'react-use/lib/useAsync';\nimport {\n  type LayoutOptions,\n  scaffolderApiRef,\n  useTemplateSecrets,\n  ReviewStepProps,\n} from '@backstage/plugin-scaffolder-react';\nimport { MultistepJsonForm } from '../MultistepJsonForm';\nimport { createValidator } from './createValidator';\n\nimport { Content, Header, InfoCard, Page } from '@backstage/core-components';\nimport {\n  AnalyticsContext,\n  errorApiRef,\n  useApi,\n  useApiHolder,\n  useRouteRef,\n  useRouteRefParams,\n} from '@backstage/core-plugin-api';\nimport { stringifyEntityRef } from '@backstage/catalog-model';\nimport {\n  rootRouteRef,\n  scaffolderTaskRouteRef,\n  selectedTemplateRouteRef,\n} from '../../routes';\nimport { LegacyFieldExtensionOptions } from '@backstage/plugin-scaffolder-react/alpha';\n\nconst useTemplateParameterSchema = (templateRef: string) => {\n  const scaffolderApi = useApi(scaffolderApiRef);\n  const { value, loading, error } = useAsync(\n    () => scaffolderApi.getTemplateParameterSchema(templateRef),\n    [scaffolderApi, templateRef],\n  );\n  return { schema: value, loading, error };\n};\n\ntype Props = {\n  ReviewStepComponent?: ComponentType<ReviewStepProps>;\n  customFieldExtensions?: LegacyFieldExtensionOptions<any, any>[];\n  layouts?: LayoutOptions[];\n  headerOptions?: {\n    pageTitleOverride?: string;\n    title?: string;\n    subtitle?: string;\n  };\n};\n\nexport const TemplatePage = ({\n  ReviewStepComponent,\n  customFieldExtensions = [],\n  layouts = [],\n  headerOptions,\n}: Props) => {\n  const apiHolder = useApiHolder();\n  const secretsContext = useTemplateSecrets();\n  const errorApi = useApi(errorApiRef);\n  const scaffolderApi = useApi(scaffolderApiRef);\n  const { templateName, namespace } = useRouteRefParams(\n    selectedTemplateRouteRef,\n  );\n  const templateRef = stringifyEntityRef({\n    name: templateName,\n    kind: 'template',\n    namespace,\n  });\n  const navigate = useNavigate();\n  const scaffolderTaskRoute = useRouteRef(scaffolderTaskRouteRef);\n  const rootRoute = useRouteRef(rootRouteRef);\n  const { schema, loading, error } = useTemplateParameterSchema(templateRef);\n  const [formState, setFormState] = useState<Record<string, any>>(() => {\n    const query = qs.parse(window.location.search, {\n      ignoreQueryPrefix: true,\n    });\n\n    try {\n      return JSON.parse(query.formData as string);\n    } catch (e) {\n      return query.formData ?? {};\n    }\n  });\n  const handleFormReset = () => setFormState({});\n  const handleChange = useCallback(\n    (e: IChangeEvent) => setFormState(e.formData),\n    [setFormState],\n  );\n\n  const handleCreate = async () => {\n    const { taskId } = await scaffolderApi.scaffold({\n      templateRef,\n      values: formState,\n      secrets: secretsContext?.secrets,\n    });\n\n    const formParams = qs.stringify(\n      { formData: formState },\n      { addQueryPrefix: true },\n    );\n    const newUrl = `${window.location.pathname}${formParams}`;\n    // We use direct history manipulation since useSearchParams and\n    // useNavigate in react-router-dom cause unnecessary extra rerenders.\n    // Also make sure to replace the state rather than pushing to avoid\n    // extra back/forward slots.\n    window.history?.replaceState(null, document.title, newUrl);\n\n    navigate(scaffolderTaskRoute({ taskId }));\n  };\n\n  if (error) {\n    errorApi.post(new Error(`Failed to load template, ${error}`));\n    return <Navigate to={rootRoute()} />;\n  }\n  if (!loading && !schema) {\n    errorApi.post(new Error('Template was not found.'));\n    return <Navigate to={rootRoute()} />;\n  }\n\n  const customFieldComponents = Object.fromEntries(\n    customFieldExtensions.map(({ name, component }) => [name, component]),\n  );\n\n  const customFieldValidators = Object.fromEntries(\n    customFieldExtensions.map(({ name, validation }) => [name, validation]),\n  );\n\n  return (\n    <AnalyticsContext attributes={{ entityRef: templateRef }}>\n      <Page themeId=\"home\">\n        <Header\n          pageTitleOverride=\"Create a New Component\"\n          title=\"Create a New Component\"\n          subtitle=\"Create new software components using standard templates\"\n          {...headerOptions}\n        />\n        <Content>\n          {loading && <LinearProgress data-testid=\"loading-progress\" />}\n          {schema && (\n            <InfoCard\n              title={schema.title}\n              noPadding\n              titleTypographyProps={{ component: 'h2' }}\n            >\n              <MultistepJsonForm\n                ReviewStepComponent={ReviewStepComponent}\n                formData={formState}\n                fields={customFieldComponents as any}\n                onChange={handleChange}\n                onReset={handleFormReset}\n                onFinish={handleCreate}\n                layouts={layouts}\n                steps={schema.steps.map(step => {\n                  return {\n                    ...step,\n                    validate: createValidator(\n                      step.schema,\n                      customFieldValidators,\n                      { apiHolder },\n                    ),\n                  };\n                })}\n              />\n            </InfoCard>\n          )}\n        </Content>\n      </Page>\n    </AnalyticsContext>\n  );\n};\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { useApiHolder } from '@backstage/core-plugin-api';\nimport { JsonObject, JsonValue } from '@backstage/types';\nimport { makeStyles } from '@material-ui/core/styles';\nimport React, { Component, ReactNode, useMemo, useState } from 'react';\nimport useDebounce from 'react-use/lib/useDebounce';\nimport yaml from 'yaml';\nimport {\n  LayoutOptions,\n  TemplateParameterSchema,\n} from '@backstage/plugin-scaffolder-react';\n\nimport { useDryRun } from '../../next/TemplateEditorPage/DryRunContext';\nimport { useDirectoryEditor } from '../../next/TemplateEditorPage/DirectoryEditorContext';\nimport { MultistepJsonForm } from '../MultistepJsonForm';\nimport { createValidator } from '../TemplatePage';\nimport { LegacyFieldExtensionOptions } from '@backstage/plugin-scaffolder-react/alpha';\n\nconst useStyles = makeStyles({\n  containerWrapper: {\n    position: 'relative',\n    width: '100%',\n    height: '100%',\n  },\n  container: {\n    position: 'absolute',\n    top: 0,\n    bottom: 0,\n    left: 0,\n    right: 0,\n    overflow: 'auto',\n  },\n});\n\ninterface ErrorBoundaryProps {\n  invalidator: unknown;\n  setErrorText(errorText: string | undefined): void;\n  children: ReactNode;\n}\n\ninterface ErrorBoundaryState {\n  shouldRender: boolean;\n}\n\nclass ErrorBoundary extends Component<ErrorBoundaryProps, ErrorBoundaryState> {\n  state = {\n    shouldRender: true,\n  };\n\n  componentDidUpdate(prevProps: { invalidator: unknown }) {\n    if (prevProps.invalidator !== this.props.invalidator) {\n      this.setState({ shouldRender: true });\n    }\n  }\n\n  componentDidCatch(error: Error) {\n    this.props.setErrorText(error.message);\n    this.setState({ shouldRender: false });\n  }\n\n  render() {\n    return this.state.shouldRender ? this.props.children : null;\n  }\n}\n\ninterface TemplateEditorFormProps {\n  content?: string;\n  /** Setting this to true will cause the content to be parsed as if it is the template entity spec */\n  contentIsSpec?: boolean;\n  data: JsonObject;\n  onUpdate: (data: JsonObject) => void;\n  setErrorText: (errorText?: string) => void;\n\n  onDryRun?: (data: JsonObject) => Promise<void>;\n  fieldExtensions?: LegacyFieldExtensionOptions<any, any>[];\n  layouts?: LayoutOptions[];\n}\n\nfunction isJsonObject(value: JsonValue | undefined): value is JsonObject {\n  return typeof value === 'object' && value !== null && !Array.isArray(value);\n}\n\n/** Shows the a template form that is parsed from the provided content */\nexport function TemplateEditorForm(props: TemplateEditorFormProps) {\n  const {\n    content,\n    contentIsSpec,\n    data,\n    onUpdate,\n    onDryRun,\n    setErrorText,\n    fieldExtensions = [],\n    layouts = [],\n  } = props;\n  const classes = useStyles();\n  const apiHolder = useApiHolder();\n\n  const [steps, setSteps] = useState<TemplateParameterSchema['steps']>();\n\n  const fields = useMemo(() => {\n    return Object.fromEntries(\n      fieldExtensions.map(({ name, component }) => [name, component]),\n    );\n  }, [fieldExtensions]);\n\n  useDebounce(\n    () => {\n      try {\n        if (!content) {\n          setSteps(undefined);\n          return;\n        }\n        const parsed: JsonValue = yaml\n          .parseAllDocuments(content)\n          .filter(c => c)\n          .map(c => c.toJSON())[0];\n\n        if (!isJsonObject(parsed)) {\n          setSteps(undefined);\n          return;\n        }\n\n        let rootObj = parsed;\n        if (!contentIsSpec) {\n          const isTemplate =\n            String(parsed.kind).toLocaleLowerCase('en-US') === 'template';\n          if (!isTemplate) {\n            setSteps(undefined);\n            return;\n          }\n\n          rootObj = isJsonObject(parsed.spec) ? parsed.spec : {};\n        }\n\n        const { parameters } = rootObj;\n\n        if (!Array.isArray(parameters)) {\n          setErrorText('Template parameters must be an array');\n          setSteps(undefined);\n          return;\n        }\n\n        const fieldValidators = Object.fromEntries(\n          fieldExtensions.map(({ name, validation }) => [name, validation]),\n        );\n\n        setErrorText();\n        setSteps(\n          parameters.flatMap(param =>\n            isJsonObject(param)\n              ? [\n                  {\n                    title: String(param.title),\n                    schema: param,\n                    validate: createValidator(param, fieldValidators, {\n                      apiHolder,\n                    }),\n                  },\n                ]\n              : [],\n          ),\n        );\n      } catch (e) {\n        setErrorText(e.message);\n      }\n    },\n    250,\n    [contentIsSpec, content, apiHolder],\n  );\n\n  if (!steps) {\n    return null;\n  }\n\n  return (\n    <div className={classes.containerWrapper}>\n      <div className={classes.container}>\n        <ErrorBoundary invalidator={steps} setErrorText={setErrorText}>\n          <MultistepJsonForm\n            steps={steps}\n            fields={fields as any}\n            formData={data}\n            onChange={e => onUpdate(e.formData)}\n            onReset={() => onUpdate({})}\n            finishButtonLabel={onDryRun && 'Try It'}\n            onFinish={onDryRun && (() => onDryRun(data))}\n            layouts={layouts}\n          />\n        </ErrorBoundary>\n      </div>\n    </div>\n  );\n}\n\n/** A version of the TemplateEditorForm that is connected to the DirectoryEditor and DryRun contexts */\nexport function TemplateEditorFormDirectoryEditorDryRun(\n  props: Pick<\n    TemplateEditorFormProps,\n    'setErrorText' | 'fieldExtensions' | 'layouts'\n  >,\n) {\n  const { setErrorText, fieldExtensions = [], layouts } = props;\n  const dryRun = useDryRun();\n\n  const directoryEditor = useDirectoryEditor();\n  const { selectedFile } = directoryEditor;\n\n  const [data, setData] = useState<JsonObject>({});\n\n  const handleDryRun = async () => {\n    if (!selectedFile) {\n      return;\n    }\n\n    try {\n      await dryRun.execute({\n        templateContent: selectedFile.content,\n        values: data,\n        files: directoryEditor.files,\n      });\n      setErrorText();\n    } catch (e) {\n      setErrorText(String(e.cause || e));\n      throw e;\n    }\n  };\n\n  const content =\n    selectedFile && selectedFile.path.match(/\\.ya?ml$/)\n      ? selectedFile.content\n      : undefined;\n\n  return (\n    <TemplateEditorForm\n      onDryRun={handleDryRun}\n      fieldExtensions={fieldExtensions}\n      setErrorText={setErrorText}\n      content={content}\n      data={data}\n      onUpdate={setData}\n      layouts={layouts}\n    />\n  );\n}\n\nTemplateEditorForm.DirectoryEditorDryRun =\n  TemplateEditorFormDirectoryEditorDryRun;\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { makeStyles } from '@material-ui/core';\nimport React, { useState } from 'react';\nimport { LegacyFieldExtensionOptions } from '@backstage/plugin-scaffolder-react/alpha';\nimport { TemplateDirectoryAccess } from '../../lib/filesystem';\nimport { LayoutOptions } from '@backstage/plugin-scaffolder-react';\nimport { DirectoryEditorProvider } from '../../next/TemplateEditorPage/DirectoryEditorContext';\nimport { DryRunProvider } from '../../next/TemplateEditorPage/DryRunContext';\nimport { TemplateEditorBrowser } from '../../next/TemplateEditorPage/TemplateEditorBrowser';\nimport { TemplateEditorTextArea } from '../../next/TemplateEditorPage/TemplateEditorTextArea';\nimport { TemplateEditorForm } from './TemplateEditorForm';\nimport { DryRunResults } from '../../next/TemplateEditorPage/DryRunResults';\n\nconst useStyles = makeStyles({\n  // Reset and fix sizing to make sure scrolling behaves correctly\n  root: {\n    gridArea: 'pageContent',\n\n    display: 'grid',\n    gridTemplateAreas: `\n      \"browser editor preview\"\n      \"results results results\"\n    `,\n    gridTemplateColumns: '1fr 3fr 2fr',\n    gridTemplateRows: '1fr auto',\n  },\n  browser: {\n    gridArea: 'browser',\n    overflow: 'auto',\n  },\n  editor: {\n    gridArea: 'editor',\n    overflow: 'auto',\n  },\n  preview: {\n    gridArea: 'preview',\n    overflow: 'auto',\n  },\n  results: {\n    gridArea: 'results',\n  },\n});\n\nexport const TemplateEditor = (props: {\n  directory: TemplateDirectoryAccess;\n  fieldExtensions?: LegacyFieldExtensionOptions<any, any>[];\n  layouts?: LayoutOptions[];\n  onClose?: () => void;\n}) => {\n  const classes = useStyles();\n\n  const [errorText, setErrorText] = useState<string>();\n\n  return (\n    <DirectoryEditorProvider directory={props.directory}>\n      <DryRunProvider>\n        <main className={classes.root}>\n          <section className={classes.browser}>\n            <TemplateEditorBrowser onClose={props.onClose} />\n          </section>\n          <section className={classes.editor}>\n            <TemplateEditorTextArea.DirectoryEditor errorText={errorText} />\n          </section>\n          <section className={classes.preview}>\n            <TemplateEditorForm.DirectoryEditorDryRun\n              setErrorText={setErrorText}\n              fieldExtensions={props.fieldExtensions}\n              layouts={props.layouts}\n            />\n          </section>\n          <section className={classes.results}>\n            <DryRunResults />\n          </section>\n        </main>\n      </DryRunProvider>\n    </DirectoryEditorProvider>\n  );\n};\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Entity } from '@backstage/catalog-model';\nimport { alertApiRef, useApi } from '@backstage/core-plugin-api';\nimport {\n  catalogApiRef,\n  humanizeEntityRef,\n} from '@backstage/plugin-catalog-react';\nimport {\n  FormControl,\n  IconButton,\n  InputLabel,\n  LinearProgress,\n  makeStyles,\n  MenuItem,\n  Select,\n} from '@material-ui/core';\nimport CloseIcon from '@material-ui/icons/Close';\nimport React, { useCallback, useState } from 'react';\nimport useAsync from 'react-use/lib/useAsync';\nimport yaml from 'yaml';\nimport { LayoutOptions } from '@backstage/plugin-scaffolder-react';\nimport { LegacyFieldExtensionOptions } from '@backstage/plugin-scaffolder-react/alpha';\nimport { TemplateEditorTextArea } from '../../next/TemplateEditorPage/TemplateEditorTextArea';\nimport { TemplateEditorForm } from './TemplateEditorForm';\n\nconst EXAMPLE_TEMPLATE_PARAMS_YAML = `# Edit the template parameters below to see how they will render in the scaffolder form UI\nparameters:\n  - title: Fill in some steps\n    required:\n      - name\n    properties:\n      name:\n        title: Name\n        type: string\n        description: Unique name of the component\n      owner:\n        title: Owner\n        type: string\n        description: Owner of the component\n        ui:field: OwnerPicker\n        ui:options:\n          catalogFilter:\n            kind: Group\n  - title: Choose a location\n    required:\n      - repoUrl\n    properties:\n      repoUrl:\n        title: Repository Location\n        type: string\n        ui:field: RepoUrlPicker\n        ui:options:\n          allowedHosts:\n            - github.com\nsteps:\n  - id: fetch-base\n    name: Fetch Base\n    action: fetch:template\n    input:\n      url: ./template\n      values:\n        name: \\${{parameters.name}}\n`;\n\ntype TemplateOption = {\n  label: string;\n  value: Entity;\n};\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    gridArea: 'pageContent',\n    display: 'grid',\n    gridTemplateAreas: `\n      \"controls controls\"\n      \"textArea preview\"\n    `,\n    gridTemplateRows: 'auto 1fr',\n    gridTemplateColumns: '1fr 1fr',\n  },\n  controls: {\n    gridArea: 'controls',\n    display: 'flex',\n    flexFlow: 'row nowrap',\n    alignItems: 'center',\n    margin: theme.spacing(1),\n  },\n  textArea: {\n    gridArea: 'textArea',\n  },\n  preview: {\n    gridArea: 'preview',\n  },\n}));\n\nexport const TemplateFormPreviewer = ({\n  defaultPreviewTemplate = EXAMPLE_TEMPLATE_PARAMS_YAML,\n  customFieldExtensions = [],\n  onClose,\n  layouts = [],\n}: {\n  defaultPreviewTemplate?: string;\n  customFieldExtensions?: LegacyFieldExtensionOptions<any, any>[];\n  onClose?: () => void;\n  layouts?: LayoutOptions[];\n}) => {\n  const classes = useStyles();\n  const alertApi = useApi(alertApiRef);\n  const catalogApi = useApi(catalogApiRef);\n  const [selectedTemplate, setSelectedTemplate] = useState('');\n  const [errorText, setErrorText] = useState<string>();\n  const [templateOptions, setTemplateOptions] = useState<TemplateOption[]>([]);\n  const [templateYaml, setTemplateYaml] = useState(defaultPreviewTemplate);\n  const [formState, setFormState] = useState({});\n\n  const { loading } = useAsync(\n    () =>\n      catalogApi\n        .getEntities({\n          filter: { kind: 'template' },\n          fields: [\n            'kind',\n            'metadata.namespace',\n            'metadata.name',\n            'metadata.title',\n            'spec.parameters',\n            'spec.steps',\n            'spec.output',\n          ],\n        })\n        .then(({ items }) =>\n          setTemplateOptions(\n            items.map(template => ({\n              label:\n                template.metadata.title ??\n                humanizeEntityRef(template, { defaultKind: 'template' }),\n              value: template,\n            })),\n          ),\n        )\n        .catch(e =>\n          alertApi.post({\n            message: `Error loading exisiting templates: ${e.message}`,\n            severity: 'error',\n          }),\n        ),\n    [catalogApi],\n  );\n\n  const handleSelectChange = useCallback(\n    // TODO(Rugvip): Afaik this should be Entity, but didn't want to make runtime changes while fixing types\n    (selected: any) => {\n      setSelectedTemplate(selected);\n      setTemplateYaml(yaml.stringify(selected.spec));\n    },\n    [setTemplateYaml],\n  );\n\n  return (\n    <>\n      {loading && <LinearProgress />}\n      <main className={classes.root}>\n        <div className={classes.controls}>\n          <FormControl variant=\"outlined\" size=\"small\" fullWidth>\n            <InputLabel id=\"select-template-label\">\n              Load Existing Template\n            </InputLabel>\n            <Select\n              value={selectedTemplate}\n              label=\"Load Existing Template\"\n              labelId=\"select-template-label\"\n              onChange={e => handleSelectChange(e.target.value)}\n            >\n              {templateOptions.map((option, idx) => (\n                <MenuItem key={idx} value={option.value as any}>\n                  {option.label}\n                </MenuItem>\n              ))}\n            </Select>\n          </FormControl>\n\n          <IconButton size=\"medium\" onClick={onClose}>\n            <CloseIcon />\n          </IconButton>\n        </div>\n        <div className={classes.textArea}>\n          <TemplateEditorTextArea\n            content={templateYaml}\n            onUpdate={setTemplateYaml}\n            errorText={errorText}\n          />\n        </div>\n        <div className={classes.preview}>\n          <TemplateEditorForm\n            data={formState}\n            onUpdate={setFormState}\n            content={templateYaml}\n            contentIsSpec\n            fieldExtensions={customFieldExtensions}\n            setErrorText={setErrorText}\n            layouts={layouts}\n          />\n        </div>\n      </main>\n    </>\n  );\n};\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { StreamLanguage } from '@codemirror/language';\nimport { yaml as yamlSupport } from '@codemirror/legacy-modes/mode/yaml';\nimport {\n  Button,\n  Card,\n  CardContent,\n  CardHeader,\n  FormControl,\n  IconButton,\n  InputLabel,\n  makeStyles,\n  MenuItem,\n  Select,\n} from '@material-ui/core';\nimport CloseIcon from '@material-ui/icons/Close';\nimport CodeMirror from '@uiw/react-codemirror';\nimport React, { useCallback, useMemo, useState } from 'react';\nimport yaml from 'yaml';\nimport { Form } from '@backstage/plugin-scaffolder-react/alpha';\nimport { TemplateEditorForm } from './TemplateEditorForm';\nimport validator from '@rjsf/validator-ajv8';\nimport { LegacyFieldExtensionOptions } from '@backstage/plugin-scaffolder-react/alpha';\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    gridArea: 'pageContent',\n    display: 'grid',\n    gridTemplateAreas: `\n      \"controls controls\"\n      \"fieldForm preview\"\n    `,\n    gridTemplateRows: 'auto 1fr',\n    gridTemplateColumns: '1fr 1fr',\n  },\n  controls: {\n    gridArea: 'controls',\n    display: 'flex',\n    flexFlow: 'row nowrap',\n    alignItems: 'center',\n    margin: theme.spacing(1),\n  },\n  fieldForm: {\n    gridArea: 'fieldForm',\n  },\n  preview: {\n    gridArea: 'preview',\n  },\n}));\n\nexport const CustomFieldExplorer = ({\n  customFieldExtensions = [],\n  onClose,\n}: {\n  customFieldExtensions?: LegacyFieldExtensionOptions<any, any>[];\n  onClose?: () => void;\n}) => {\n  const classes = useStyles();\n  const fieldOptions = customFieldExtensions.filter(field => !!field.schema);\n  const [selectedField, setSelectedField] = useState(fieldOptions[0]);\n  const [fieldFormState, setFieldFormState] = useState({});\n  const [refreshKey, setRefreshKey] = useState(Date.now());\n  const [formState, setFormState] = useState({});\n  const sampleFieldTemplate = useMemo(\n    () =>\n      yaml.stringify({\n        parameters: [\n          {\n            title: `${selectedField.name} Example`,\n            properties: {\n              [selectedField.name]: {\n                type: selectedField.schema?.returnValue?.type,\n                'ui:field': selectedField.name,\n                'ui:options': fieldFormState,\n              },\n            },\n          },\n        ],\n      }),\n    [fieldFormState, selectedField],\n  );\n\n  const fieldComponents = useMemo(() => {\n    return Object.fromEntries(\n      customFieldExtensions.map(({ name, component }) => [name, component]),\n    );\n  }, [customFieldExtensions]);\n\n  const handleSelectionChange = useCallback(\n    (selection: LegacyFieldExtensionOptions) => {\n      setSelectedField(selection);\n      setFieldFormState({});\n      setFormState({});\n    },\n    [setFieldFormState, setSelectedField, setFormState],\n  );\n\n  const handleFieldConfigChange = useCallback(\n    (state: {}) => {\n      setFieldFormState(state);\n      // Force TemplateEditorForm to re-render since some fields\n      // may not be responsive to ui:option changes\n      setRefreshKey(Date.now());\n    },\n    [setFieldFormState, setRefreshKey],\n  );\n\n  return (\n    <main className={classes.root}>\n      <div className={classes.controls}>\n        <FormControl variant=\"outlined\" size=\"small\" fullWidth>\n          <InputLabel id=\"select-field-label\">\n            Choose Custom Field Extension\n          </InputLabel>\n          <Select\n            value={selectedField}\n            label=\"Choose Custom Field Extension\"\n            labelId=\"select-field-label\"\n            onChange={e =>\n              handleSelectionChange(\n                e.target.value as LegacyFieldExtensionOptions,\n              )\n            }\n          >\n            {fieldOptions.map((option, idx) => (\n              <MenuItem key={idx} value={option as any}>\n                {option.name}\n              </MenuItem>\n            ))}\n          </Select>\n        </FormControl>\n\n        <IconButton size=\"medium\" onClick={onClose} aria-label=\"Close\">\n          <CloseIcon />\n        </IconButton>\n      </div>\n      <div className={classes.fieldForm}>\n        <Card>\n          <CardHeader title=\"Field Options\" />\n          <CardContent>\n            <Form\n              showErrorList={false}\n              fields={{ ...fieldComponents }}\n              noHtml5Validate\n              formData={fieldFormState}\n              formContext={{ fieldFormState }}\n              onSubmit={e => handleFieldConfigChange(e.formData)}\n              validator={validator}\n              schema={selectedField.schema?.uiOptions || {}}\n              experimental_defaultFormStateBehavior={{\n                allOf: 'populateDefaults',\n              }}\n            >\n              <Button\n                variant=\"contained\"\n                color=\"primary\"\n                type=\"submit\"\n                disabled={!selectedField.schema?.uiOptions}\n              >\n                Apply\n              </Button>\n            </Form>\n          </CardContent>\n        </Card>\n      </div>\n      <div className={classes.preview}>\n        <Card>\n          <CardHeader title=\"Example Template Spec\" />\n          <CardContent>\n            <CodeMirror\n              readOnly\n              theme=\"dark\"\n              height=\"100%\"\n              extensions={[StreamLanguage.define(yamlSupport)]}\n              value={sampleFieldTemplate}\n            />\n          </CardContent>\n        </Card>\n        <TemplateEditorForm\n          data={formState}\n          onUpdate={setFormState}\n          key={refreshKey}\n          content={sampleFieldTemplate}\n          contentIsSpec\n          fieldExtensions={customFieldExtensions}\n          setErrorText={() => null}\n        />\n      </div>\n    </main>\n  );\n};\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React, { useState } from 'react';\nimport { Content, Header, Page } from '@backstage/core-components';\nimport {\n  TemplateDirectoryAccess,\n  WebFileSystemAccess,\n} from '../../lib/filesystem';\nimport { type LayoutOptions } from '@backstage/plugin-scaffolder-react';\nimport { LegacyFieldExtensionOptions } from '@backstage/plugin-scaffolder-react/alpha';\nimport { TemplateEditorIntro } from '../../next/TemplateEditorPage/TemplateEditorIntro';\nimport { TemplateEditor } from './TemplateEditor';\nimport { TemplateFormPreviewer } from './TemplateFormPreviewer';\nimport { CustomFieldExplorer } from './CustomFieldExplorer';\n\ntype Selection =\n  | {\n      type: 'local';\n      directory: TemplateDirectoryAccess;\n    }\n  | {\n      type: 'form';\n    }\n  | {\n      type: 'field-explorer';\n    };\n\ninterface TemplateEditorPageProps {\n  defaultPreviewTemplate?: string;\n  customFieldExtensions?: LegacyFieldExtensionOptions<any, any>[];\n  layouts?: LayoutOptions[];\n}\n\nexport function TemplateEditorPage(props: TemplateEditorPageProps) {\n  const [selection, setSelection] = useState<Selection>();\n\n  let content: JSX.Element | null = null;\n  if (selection?.type === 'local') {\n    content = (\n      <TemplateEditor\n        directory={selection.directory}\n        fieldExtensions={props.customFieldExtensions}\n        onClose={() => setSelection(undefined)}\n        layouts={props.layouts}\n      />\n    );\n  } else if (selection?.type === 'form') {\n    content = (\n      <TemplateFormPreviewer\n        defaultPreviewTemplate={props.defaultPreviewTemplate}\n        customFieldExtensions={props.customFieldExtensions}\n        onClose={() => setSelection(undefined)}\n        layouts={props.layouts}\n      />\n    );\n  } else if (selection?.type === 'field-explorer') {\n    content = (\n      <CustomFieldExplorer\n        customFieldExtensions={props.customFieldExtensions}\n        onClose={() => setSelection(undefined)}\n      />\n    );\n  } else {\n    content = (\n      <Content>\n        <TemplateEditorIntro\n          onSelect={option => {\n            if (option === 'local') {\n              WebFileSystemAccess.requestDirectoryAccess()\n                .then(directory => setSelection({ type: 'local', directory }))\n                .catch(() => {});\n            } else if (option === 'form') {\n              setSelection({ type: 'form' });\n            } else if (option === 'field-explorer') {\n              setSelection({ type: 'field-explorer' });\n            }\n          }}\n        />\n      </Content>\n    );\n  }\n\n  return (\n    <Page themeId=\"home\">\n      <Header\n        title=\"Template Editor\"\n        subtitle=\"Edit, preview, and try out templates and template forms\"\n      />\n      {content}\n    </Page>\n  );\n}\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { ComponentType, useEffect, PropsWithChildren } from 'react';\nimport { Navigate, Route, Routes, useOutlet } from 'react-router-dom';\nimport { Entity } from '@backstage/catalog-model';\nimport { TemplateEntityV1beta3 } from '@backstage/plugin-scaffolder-common';\nimport { ScaffolderPage } from './ScaffolderPage';\nimport { TemplatePage } from './TemplatePage';\nimport { TaskPage } from './TaskPage';\nimport { ActionsPage } from '../components/ActionsPage';\nimport { DEFAULT_SCAFFOLDER_FIELD_EXTENSIONS } from '../extensions/default';\nimport { useRouteRef, useRouteRefParams } from '@backstage/core-plugin-api';\nimport { LegacyFieldExtensionOptions } from '@backstage/plugin-scaffolder-react/alpha';\nimport {\n  ReviewStepProps,\n  SecretsContextProvider,\n  useCustomFieldExtensions,\n  useCustomLayouts,\n} from '@backstage/plugin-scaffolder-react';\nimport { ListTasksPage } from '../components/ListTasksPage';\nimport {\n  actionsRouteRef,\n  editRouteRef,\n  legacySelectedTemplateRouteRef,\n  scaffolderListTaskRouteRef,\n  scaffolderTaskRouteRef,\n  selectedTemplateRouteRef,\n} from '../routes';\nimport { TemplateEditorPage } from './TemplateEditorPage';\n\n/**\n * The props for the entrypoint `ScaffolderPage` component the plugin.\n * @alpha\n */\nexport type LegacyRouterProps = {\n  components?: {\n    ReviewStepComponent?: ComponentType<ReviewStepProps>;\n    TemplateCardComponent?:\n      | ComponentType<{ template: TemplateEntityV1beta3 }>\n      | undefined;\n    TaskPageComponent?: ComponentType<PropsWithChildren<{}>>;\n  };\n  groups?: Array<{\n    title?: React.ReactNode;\n    filter: (entity: Entity) => boolean;\n  }>;\n  templateFilter?: (entity: TemplateEntityV1beta3) => boolean;\n  defaultPreviewTemplate?: string;\n  headerOptions?: {\n    pageTitleOverride?: string;\n    title?: string;\n    subtitle?: string;\n  };\n  /**\n   * Options for the context menu on the scaffolder page.\n   */\n  contextMenu?: {\n    /** Whether to show a link to the template editor */\n    editor?: boolean;\n    /** Whether to show a link to the actions documentation */\n    actions?: boolean;\n  };\n};\n\n/**\n * The legacy router\n *\n * @alpha\n */\nexport const LegacyRouter = (props: LegacyRouterProps) => {\n  const {\n    groups,\n    templateFilter,\n    components = {},\n    defaultPreviewTemplate,\n  } = props;\n\n  const { ReviewStepComponent, TemplateCardComponent, TaskPageComponent } =\n    components;\n\n  const outlet = useOutlet();\n  const TaskPageElement = TaskPageComponent ?? TaskPage;\n\n  const customFieldExtensions =\n    useCustomFieldExtensions<LegacyFieldExtensionOptions>(outlet);\n\n  const fieldExtensions = [\n    ...customFieldExtensions,\n    ...DEFAULT_SCAFFOLDER_FIELD_EXTENSIONS.filter(\n      ({ name }) =>\n        !customFieldExtensions.some(\n          customFieldExtension => customFieldExtension.name === name,\n        ),\n    ),\n  ] as LegacyFieldExtensionOptions[];\n\n  const customLayouts = useCustomLayouts(outlet);\n\n  /**\n   * This component can be deleted once the older routes have been deprecated.\n   */\n  const RedirectingComponent = () => {\n    const { templateName } = useRouteRefParams(legacySelectedTemplateRouteRef);\n    const newLink = useRouteRef(selectedTemplateRouteRef);\n    useEffect(\n      () =>\n        // eslint-disable-next-line no-console\n        console.warn(\n          'The route /template/:templateName is deprecated, please use the new /template/:namespace/:templateName route instead',\n        ),\n      [],\n    );\n    return <Navigate to={newLink({ namespace: 'default', templateName })} />;\n  };\n\n  return (\n    <Routes>\n      <Route\n        path=\"/\"\n        element={\n          <ScaffolderPage\n            groups={groups}\n            templateFilter={templateFilter}\n            TemplateCardComponent={TemplateCardComponent}\n            contextMenu={props.contextMenu}\n            headerOptions={props.headerOptions}\n          />\n        }\n      />\n      <Route\n        path={legacySelectedTemplateRouteRef.path}\n        element={<RedirectingComponent />}\n      />\n      <Route\n        path={selectedTemplateRouteRef.path}\n        element={\n          <SecretsContextProvider>\n            <TemplatePage\n              ReviewStepComponent={ReviewStepComponent}\n              customFieldExtensions={fieldExtensions}\n              layouts={customLayouts}\n              headerOptions={props.headerOptions}\n            />\n          </SecretsContextProvider>\n        }\n      />\n      <Route\n        path={scaffolderListTaskRouteRef.path}\n        element={<ListTasksPage />}\n      />\n      <Route path={scaffolderTaskRouteRef.path} element={<TaskPageElement />} />\n      <Route path={actionsRouteRef.path} element={<ActionsPage />} />\n      <Route\n        path={editRouteRef.path}\n        element={\n          <SecretsContextProvider>\n            <TemplateEditorPage\n              defaultPreviewTemplate={defaultPreviewTemplate}\n              customFieldExtensions={fieldExtensions}\n              layouts={customLayouts}\n            />\n          </SecretsContextProvider>\n        }\n      />\n\n      <Route path=\"preview\" element={<Navigate to=\"../edit\" />} />\n    </Routes>\n  );\n};\n"],"names":["useStyles","_a","makeStyles","IconButton","isObject","MuiTheme","StepUI","MenuItem","_b","Form","yamlSupport"],"mappings":"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"}