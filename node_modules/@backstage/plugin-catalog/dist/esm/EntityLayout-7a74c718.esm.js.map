{"version":3,"file":"EntityLayout-7a74c718.esm.js","sources":["../../src/components/EntityContextMenu/UnregisterEntity.tsx","../../src/components/EntityContextMenu/EntityContextMenu.tsx","../../src/components/EntityLayout/EntityLayout.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { ListItemIcon, ListItemText, MenuItem } from '@material-ui/core';\nimport CancelIcon from '@material-ui/icons/Cancel';\n\ntype VisibleType = 'visible' | 'hidden' | 'disable';\n\nexport type UnregisterEntityOptions = {\n  disableUnregister: boolean | VisibleType;\n};\n\ninterface UnregisterEntityProps {\n  unregisterEntityOptions?: UnregisterEntityOptions;\n  isUnregisterAllowed: boolean;\n  onUnregisterEntity: () => void;\n  onClose: () => void;\n}\n\nexport function UnregisterEntity(props: UnregisterEntityProps) {\n  const {\n    unregisterEntityOptions,\n    isUnregisterAllowed,\n    onUnregisterEntity,\n    onClose,\n  } = props;\n\n  const isBoolean =\n    typeof unregisterEntityOptions?.disableUnregister === 'boolean';\n\n  const isDisabled =\n    (!isUnregisterAllowed ||\n      (isBoolean\n        ? !!unregisterEntityOptions?.disableUnregister\n        : unregisterEntityOptions?.disableUnregister === 'disable')) ??\n    false;\n\n  let unregisterButton = <></>;\n\n  if (unregisterEntityOptions?.disableUnregister !== 'hidden') {\n    unregisterButton = (\n      <MenuItem\n        onClick={() => {\n          onClose();\n          onUnregisterEntity();\n        }}\n        disabled={isDisabled}\n      >\n        <ListItemIcon>\n          <CancelIcon fontSize=\"small\" />\n        </ListItemIcon>\n        <ListItemText primary=\"Unregister entity\" />\n      </MenuItem>\n    );\n  }\n\n  return <>{unregisterButton}</>;\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Divider,\n  IconButton,\n  ListItemIcon,\n  ListItemText,\n  MenuItem,\n  MenuList,\n  Popover,\n  Tooltip,\n} from '@material-ui/core';\nimport { Theme, makeStyles } from '@material-ui/core/styles';\nimport BugReportIcon from '@material-ui/icons/BugReport';\nimport MoreVert from '@material-ui/icons/MoreVert';\nimport FileCopyTwoToneIcon from '@material-ui/icons/FileCopyTwoTone';\nimport React, { useEffect, useState } from 'react';\nimport { IconComponent } from '@backstage/core-plugin-api';\nimport { useEntityPermission } from '@backstage/plugin-catalog-react/alpha';\nimport { catalogEntityDeletePermission } from '@backstage/plugin-catalog-common/alpha';\nimport { UnregisterEntity, UnregisterEntityOptions } from './UnregisterEntity';\nimport { useApi, alertApiRef } from '@backstage/core-plugin-api';\nimport useCopyToClipboard from 'react-use/lib/useCopyToClipboard';\n\n/** @public */\nexport type EntityContextMenuClassKey = 'button';\n\nconst useStyles = makeStyles(\n  (theme: Theme) => {\n    return {\n      button: {\n        color: theme.page.fontColor,\n      },\n    };\n  },\n  { name: 'PluginCatalogEntityContextMenu' },\n);\n\n// NOTE(freben): Intentionally not exported at this point, since it's part of\n// the unstable extra context menu items concept below\ninterface ExtraContextMenuItem {\n  title: string;\n  Icon: IconComponent;\n  onClick: () => void;\n}\n\ninterface EntityContextMenuProps {\n  UNSTABLE_extraContextMenuItems?: ExtraContextMenuItem[];\n  UNSTABLE_contextMenuOptions?: UnregisterEntityOptions;\n  onUnregisterEntity: () => void;\n  onInspectEntity: () => void;\n}\n\nexport function EntityContextMenu(props: EntityContextMenuProps) {\n  const {\n    UNSTABLE_extraContextMenuItems,\n    UNSTABLE_contextMenuOptions,\n    onUnregisterEntity,\n    onInspectEntity,\n  } = props;\n  const [anchorEl, setAnchorEl] = useState<HTMLButtonElement>();\n  const classes = useStyles();\n  const unregisterPermission = useEntityPermission(\n    catalogEntityDeletePermission,\n  );\n  const isAllowed = unregisterPermission.allowed;\n\n  const onOpen = (event: React.SyntheticEvent<HTMLButtonElement>) => {\n    setAnchorEl(event.currentTarget);\n  };\n\n  const onClose = () => {\n    setAnchorEl(undefined);\n  };\n\n  const alertApi = useApi(alertApiRef);\n  const [copyState, copyToClipboard] = useCopyToClipboard();\n  useEffect(() => {\n    if (!copyState.error && copyState.value) {\n      alertApi.post({\n        message: 'Copied!',\n        severity: 'info',\n        display: 'transient',\n      });\n    }\n  }, [copyState, alertApi]);\n\n  const extraItems = UNSTABLE_extraContextMenuItems && [\n    ...UNSTABLE_extraContextMenuItems.map(item => (\n      <MenuItem\n        key={item.title}\n        onClick={() => {\n          onClose();\n          item.onClick();\n        }}\n      >\n        <ListItemIcon>\n          <item.Icon fontSize=\"small\" />\n        </ListItemIcon>\n        <ListItemText primary={item.title} />\n      </MenuItem>\n    )),\n    <Divider key=\"the divider is here!\" />,\n  ];\n\n  return (\n    <>\n      <Tooltip title=\"More\" arrow>\n        <IconButton\n          aria-label=\"more\"\n          aria-controls=\"long-menu\"\n          aria-haspopup=\"true\"\n          aria-expanded={!!anchorEl}\n          role=\"button\"\n          onClick={onOpen}\n          data-testid=\"menu-button\"\n          className={classes.button}\n          id=\"long-menu\"\n        >\n          <MoreVert />\n        </IconButton>\n      </Tooltip>\n      <Popover\n        open={Boolean(anchorEl)}\n        onClose={onClose}\n        anchorEl={anchorEl}\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'right' }}\n        transformOrigin={{ vertical: 'top', horizontal: 'right' }}\n        aria-labelledby=\"long-menu\"\n      >\n        <MenuList autoFocusItem={Boolean(anchorEl)}>\n          {extraItems}\n          <UnregisterEntity\n            unregisterEntityOptions={UNSTABLE_contextMenuOptions}\n            isUnregisterAllowed={isAllowed}\n            onUnregisterEntity={onUnregisterEntity}\n            onClose={onClose}\n          />\n          <MenuItem\n            onClick={() => {\n              onClose();\n              onInspectEntity();\n            }}\n          >\n            <ListItemIcon>\n              <BugReportIcon fontSize=\"small\" />\n            </ListItemIcon>\n            <ListItemText primary=\"Inspect entity\" />\n          </MenuItem>\n          <MenuItem\n            onClick={() => {\n              onClose();\n              copyToClipboard(window.location.toString());\n            }}\n          >\n            <ListItemIcon>\n              <FileCopyTwoToneIcon fontSize=\"small\" />\n            </ListItemIcon>\n            <ListItemText primary=\"Copy entity URL\" />\n          </MenuItem>\n        </MenuList>\n      </Popover>\n    </>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Entity,\n  DEFAULT_NAMESPACE,\n  RELATION_OWNED_BY,\n} from '@backstage/catalog-model';\nimport {\n  Content,\n  Header,\n  HeaderLabel,\n  Link,\n  Page,\n  Progress,\n  RoutedTabs,\n  WarningPanel,\n} from '@backstage/core-components';\nimport {\n  attachComponentData,\n  IconComponent,\n  useElementFilter,\n  useRouteRef,\n  useRouteRefParams,\n} from '@backstage/core-plugin-api';\nimport {\n  EntityDisplayName,\n  EntityRefLinks,\n  entityRouteRef,\n  FavoriteEntity,\n  getEntityRelations,\n  InspectEntityDialog,\n  UnregisterEntityDialog,\n  useAsyncEntity,\n} from '@backstage/plugin-catalog-react';\nimport { Box, TabProps } from '@material-ui/core';\nimport { Alert } from '@material-ui/lab';\nimport React, { useEffect, useState } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport { EntityContextMenu } from '../EntityContextMenu/EntityContextMenu';\nimport { rootRouteRef, unregisterRedirectRouteRef } from '../../routes';\n\n/** @public */\nexport type EntityLayoutRouteProps = {\n  path: string;\n  title: string;\n  children: JSX.Element;\n  if?: (entity: Entity) => boolean;\n  tabProps?: TabProps<React.ElementType, { component?: React.ElementType }>;\n};\n\nconst dataKey = 'plugin.catalog.entityLayoutRoute';\n\nconst Route: (props: EntityLayoutRouteProps) => null = () => null;\nattachComponentData(Route, dataKey, true);\nattachComponentData(Route, 'core.gatherMountPoints', true); // This causes all mount points that are discovered within this route to use the path of the route itself\n\nfunction EntityLayoutTitle(props: {\n  title: string;\n  entity: Entity | undefined;\n}) {\n  const { entity, title } = props;\n  return (\n    <Box display=\"inline-flex\" alignItems=\"center\" height=\"1em\" maxWidth=\"100%\">\n      <Box\n        component=\"span\"\n        textOverflow=\"ellipsis\"\n        whiteSpace=\"nowrap\"\n        overflow=\"hidden\"\n      >\n        {entity ? <EntityDisplayName entityRef={entity} hideIcon /> : title}\n      </Box>\n      {entity && <FavoriteEntity entity={entity} />}\n    </Box>\n  );\n}\n\nfunction headerProps(\n  paramKind: string | undefined,\n  paramNamespace: string | undefined,\n  paramName: string | undefined,\n  entity: Entity | undefined,\n): { headerTitle: string; headerType: string } {\n  const kind = paramKind ?? entity?.kind ?? '';\n  const namespace = paramNamespace ?? entity?.metadata.namespace ?? '';\n  const name =\n    entity?.metadata.title ?? paramName ?? entity?.metadata.name ?? '';\n  return {\n    headerTitle: `${name}${\n      namespace && namespace !== DEFAULT_NAMESPACE ? ` in ${namespace}` : ''\n    }`,\n    headerType: (() => {\n      let t = kind.toLocaleLowerCase('en-US');\n      if (entity && entity.spec && 'type' in entity.spec) {\n        t += ' — ';\n        t += (entity.spec as { type: string }).type.toLocaleLowerCase('en-US');\n      }\n      return t;\n    })(),\n  };\n}\n\nfunction EntityLabels(props: { entity: Entity }) {\n  const { entity } = props;\n  const ownedByRelations = getEntityRelations(entity, RELATION_OWNED_BY);\n  return (\n    <>\n      {ownedByRelations.length > 0 && (\n        <HeaderLabel\n          label=\"Owner\"\n          contentTypograpyRootComponent=\"p\"\n          value={\n            <EntityRefLinks\n              entityRefs={ownedByRelations}\n              defaultKind=\"Group\"\n              color=\"inherit\"\n            />\n          }\n        />\n      )}\n      {entity.spec?.lifecycle && (\n        <HeaderLabel\n          label=\"Lifecycle\"\n          value={entity.spec.lifecycle?.toString()}\n        />\n      )}\n    </>\n  );\n}\n\n// NOTE(freben): Intentionally not exported at this point, since it's part of\n// the unstable extra context menu items concept below\ninterface ExtraContextMenuItem {\n  title: string;\n  Icon: IconComponent;\n  onClick: () => void;\n}\n\ntype VisibleType = 'visible' | 'hidden' | 'disable';\n\n// NOTE(blam): Intentionally not exported at this point, since it's part of\n// unstable context menu option, eg: disable the unregister entity menu\ninterface EntityContextMenuOptions {\n  disableUnregister: boolean | VisibleType;\n}\n\n/** @public */\nexport interface EntityLayoutProps {\n  UNSTABLE_extraContextMenuItems?: ExtraContextMenuItem[];\n  UNSTABLE_contextMenuOptions?: EntityContextMenuOptions;\n  children?: React.ReactNode;\n  NotFoundComponent?: React.ReactNode;\n}\n\n/**\n * EntityLayout is a compound component, which allows you to define a layout for\n * entities using a sub-navigation mechanism.\n *\n * Consists of two parts: EntityLayout and EntityLayout.Route\n *\n * @example\n * ```jsx\n * <EntityLayout>\n *   <EntityLayout.Route path=\"/example\" title=\"Example tab\">\n *     <div>This is rendered under /example/anything-here route</div>\n *   </EntityLayout.Route>\n * </EntityLayout>\n * ```\n *\n * @public\n */\nexport const EntityLayout = (props: EntityLayoutProps) => {\n  const {\n    UNSTABLE_extraContextMenuItems,\n    UNSTABLE_contextMenuOptions,\n    children,\n    NotFoundComponent,\n  } = props;\n  const { kind, namespace, name } = useRouteRefParams(entityRouteRef);\n  const { entity, loading, error } = useAsyncEntity();\n  const location = useLocation();\n  const routes = useElementFilter(\n    children,\n    elements =>\n      elements\n        .selectByComponentData({\n          key: dataKey,\n          withStrictError:\n            'Child of EntityLayout must be an EntityLayout.Route',\n        })\n        .getElements<EntityLayoutRouteProps>() // all nodes, element data, maintain structure or not?\n        .flatMap(({ props: elementProps }) => {\n          if (!entity) {\n            return [];\n          } else if (elementProps.if && !elementProps.if(entity)) {\n            return [];\n          }\n\n          return [\n            {\n              path: elementProps.path,\n              title: elementProps.title,\n              children: elementProps.children,\n              tabProps: elementProps.tabProps,\n            },\n          ];\n        }),\n    [entity],\n  );\n\n  const { headerTitle, headerType } = headerProps(\n    kind,\n    namespace,\n    name,\n    entity,\n  );\n\n  const [confirmationDialogOpen, setConfirmationDialogOpen] = useState(false);\n  const [inspectionDialogOpen, setInspectionDialogOpen] = useState(false);\n  const navigate = useNavigate();\n  const catalogRoute = useRouteRef(rootRouteRef);\n  const unregisterRedirectRoute = useRouteRef(unregisterRedirectRouteRef);\n\n  const cleanUpAfterRemoval = async () => {\n    setConfirmationDialogOpen(false);\n    setInspectionDialogOpen(false);\n    navigate(\n      unregisterRedirectRoute ? unregisterRedirectRoute() : catalogRoute(),\n    );\n  };\n\n  // Make sure to close the dialog if the user clicks links in it that navigate\n  // to another entity.\n  useEffect(() => {\n    setConfirmationDialogOpen(false);\n    setInspectionDialogOpen(false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [location.pathname]);\n\n  return (\n    <Page themeId={entity?.spec?.type?.toString() ?? 'home'}>\n      <Header\n        title={<EntityLayoutTitle title={headerTitle} entity={entity!} />}\n        pageTitleOverride={headerTitle}\n        type={headerType}\n      >\n        {entity && (\n          <>\n            <EntityLabels entity={entity} />\n            <EntityContextMenu\n              UNSTABLE_extraContextMenuItems={UNSTABLE_extraContextMenuItems}\n              UNSTABLE_contextMenuOptions={UNSTABLE_contextMenuOptions}\n              onUnregisterEntity={() => setConfirmationDialogOpen(true)}\n              onInspectEntity={() => setInspectionDialogOpen(true)}\n            />\n          </>\n        )}\n      </Header>\n\n      {loading && <Progress />}\n\n      {entity && <RoutedTabs routes={routes} />}\n\n      {error && (\n        <Content>\n          <Alert severity=\"error\">{error.toString()}</Alert>\n        </Content>\n      )}\n\n      {!loading && !error && !entity && (\n        <Content>\n          {NotFoundComponent ? (\n            NotFoundComponent\n          ) : (\n            <WarningPanel title=\"Entity not found\">\n              There is no {kind} with the requested{' '}\n              <Link to=\"https://backstage.io/docs/features/software-catalog/references\">\n                kind, namespace, and name\n              </Link>\n              .\n            </WarningPanel>\n          )}\n        </Content>\n      )}\n\n      <UnregisterEntityDialog\n        open={confirmationDialogOpen}\n        entity={entity!}\n        onConfirm={cleanUpAfterRemoval}\n        onClose={() => setConfirmationDialogOpen(false)}\n      />\n      <InspectEntityDialog\n        open={inspectionDialogOpen}\n        entity={entity!}\n        onClose={() => setInspectionDialogOpen(false)}\n      />\n    </Page>\n  );\n};\n\nEntityLayout.Route = Route;\n"],"names":[],"mappings":"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"}