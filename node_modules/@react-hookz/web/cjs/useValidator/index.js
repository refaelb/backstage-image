"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useValidator = void 0;
const react_1 = require("react");
const useSyncedRef_1 = require("../useSyncedRef");
/**
 * Performs validation when any of provided dependencies has changed.
 *
 * @param validator Function that performs validation.
 * @param deps Dependencies list that passed straight to underlying `useEffect`.
 * @param initialValidity Initial validity state.
 */
function useValidator(validator, deps, initialValidity = { isValid: undefined }) {
    const [validity, setValidity] = (0, react_1.useState)(initialValidity);
    const validatorRef = (0, useSyncedRef_1.useSyncedRef)(() => {
        if (validator.length) {
            validator(setValidity);
        }
        else {
            setValidity(validator());
        }
    });
    (0, react_1.useEffect)(() => {
        validatorRef.current();
    }, deps);
    return [
        validity,
        (0, react_1.useCallback)(() => {
            validatorRef.current();
        }, []),
    ];
}
exports.useValidator = useValidator;
