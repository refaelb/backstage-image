"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useClickOutside = void 0;
const react_1 = require("react");
const misc_1 = require("../util/misc");
const useSyncedRef_1 = require("../useSyncedRef");
const DEFAULT_EVENTS = ['mousedown', 'touchstart'];
/**
 * Triggers a callback when the user clicks outside a target element.
 *
 * @param ref React ref object containing the target HTML element.
 * @param callback Callback invoked when the user clicks outside the target element.
 * @param events List of events that will be used as triggers for the outside click. Default:
 * 'mousedown', 'touchstart'
 */
function useClickOutside(ref, callback, events = DEFAULT_EVENTS) {
    const cbRef = (0, useSyncedRef_1.useSyncedRef)(callback);
    const refRef = (0, useSyncedRef_1.useSyncedRef)(ref);
    (0, react_1.useEffect)(() => {
        function handler(event) {
            if (!refRef.current.current)
                return;
            const { target: evtTarget } = event;
            const cb = cbRef.current;
            if (!evtTarget ||
                (Boolean(evtTarget) && !refRef.current.current.contains(evtTarget))) {
                cb.call(this, event);
            }
        }
        events.forEach((name) => {
            (0, misc_1.on)(document, name, handler, { passive: true });
        });
        return () => {
            events.forEach((name) => {
                (0, misc_1.off)(document, name, handler, { passive: true });
            });
        };
    }, [...events]);
}
exports.useClickOutside = useClickOutside;
